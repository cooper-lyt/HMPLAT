<!DOCTYPE composition PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
        "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<ui:composition xmlns="http://www.w3.org/1999/xhtml"
                xmlns:s="http://jboss.org/schema/seam/taglib"
                xmlns:ui="http://xmlns.jcp.org/jsf/facelets"
                xmlns:h="http://xmlns.jcp.org/jsf/html"
                xmlns:a="http://richfaces.org/a4j"

                xmlns:p="http://xmlns.jcp.org/jsf/passthrough"
                xmlns:f="http://xmlns.jcp.org/jsf/core"
                xmlns:c="http://xmlns.jcp.org/jsp/jstl/core"
                xmlns:fn="http://xmlns.jcp.org/jsp/jstl/functions"
                template="/layout/template.xhtml">


    <ui:define name="body">


    <div class="pagehead repohead instapaper_ignore readability-menu">

        <div class="container">

            <h1 class="entry-title public">
                <span class="mega-octicon octicon-repo"></span>
                <strong>#{messages.createBusiness}</strong>


                <span class="path-divider">/</span>

                #{ownerBusinessHome.instance.defineName}

                <span class="path-divider">/</span>
                #{messages.Business_Start_ProjectSelect}

            </h1>

        </div>


    </div>




    <div class="container">


        <h:selectOneMenu value="#{sectionSelectList.districtId}"
                         p:data-header="#{messages.districtSelect}"
                         styleClass="selectpicker edit-select form-control">
            <s:selectItems value="#{allDistrict.resultList}" var="_district"
                           itemValue="#{_district.id}" label="#{_district.name}"
                           noSelectionLabel="#{messages.districtSelect}"/>

            <a:ajax event="valueChange" execute="@this" listener="#{houseStepSelect.resetSection}" render="sectionSelectInputs">
                <a:attachQueue requestDelay="0"/>
            </a:ajax>
        </h:selectOneMenu>
        <a:outputPanel id="sectionSelectInputs" >

            <h:outputScript>
                var scrollTopValue = 0;

                function moreBefor(){
                var div = #{r:element('SectionSelectItemList')};
                scrollTopValue = div.scrollTop;

                }

                function scrollToBefor(){
                var div = #{r:element('SectionSelectItemList')};

                div.scrollTop = scrollTopValue;
                }

            </h:outputScript>

            <a:jsFunction name="moreResult" execute="@this" immediate="true" action="#{sectionSelectList.moreResult}"
                          oncomplete="scrollToBefor(); "
                          render="sectionSelectBtnCaption,SectionSelectItemList,projectSelectInputs">
                <a:attachQueue requestDelay="0"/>
            </a:jsFunction>

            <div class="btn-group bootstrap-select edit-select" style="width: 100%;">
                <button type="button" class=" btn dropdown-toggle btn-default"
                        data-toggle="dropdown" aria-expanded="false">

                    <h:outputText id="sectionSelectBtnCaption" styleClass="filter-option pull-left"
                                  value="#{(empty houseStepSelect.selectSection) ?  messages.sectionSelect : houseStepSelect.selectSection.name}">
                    </h:outputText>
                    <span class="caret"></span>
                </button>


                <div class="dropdown-menu select-menu-modal-holder" >
                    <div class="select-menu-modal" >
                        <div class="select-menu-header">
                            <span class="select-menu-title">#{messages.SectionSelect}</span>
                                            <span class="octicon octicon-x js-menu-close"
                                                  aria-label="#{messages.close}"></span>
                        </div>

                        <a:outputPanel layout="block" id="sectionSelectPanel">
                            <div class="select-menu-filters">
                                <div class="select-menu-text-filter">
                                    <h:inputText id="sectionSearchName" autocomplete="off" value="#{sectionSelectList.searchKey}">
                                        <a:ajax event="keyup" immediate="true" execute="@this"
                                                render="SectionSelectItemList">
                                            <a:attachQueue requestDelay="500"/>
                                        </a:ajax>

                                    </h:inputText>
                                </div>
                            </div>
                            <a:outputPanel layout="block" styleClass="select-menu-list" id="SectionSelectItemList">

                                <a:commandLink execute="@this" immediate="true" action="#{houseStepSelect.resetSection}"
                                               render="sectionSelectBtnCaption,SectionSelectItemList,projectSelectInputs"
                                               styleClass="select-menu-item #{(empty houseStepSelect.selectSection) ? 'selected': ''}">

                                    <a:param value="" assignTo="#{houseStepSelect.selectSectionId}"/>
                                    <span class="select-menu-item-icon octicon octicon-check"></span>
                                    <span class="select-menu-item-text">#{messages.sectionSelect}</span>
                                    <a:attachQueue requestDelay="0"/>
                                </a:commandLink>

                                <a:repeat value="#{sectionSelectList.resultList}" var="_item">

                                    <a:commandLink execute="@this" immediate="true"
                                                   render="sectionSelectBtnCaption,SectionSelectItemList,projectSelectInputs" action="#{houseStepSelect.resetPorject}"
                                                   styleClass="select-menu-item #{(houseStepSelect.selectSectionId eq _item.id) ? 'selected': ''}">

                                        <a:param value="#{_item.id}" assignTo="#{houseStepSelect.selectSectionId}"/>

                                        <span class="select-menu-item-icon octicon octicon-check"></span>
                                        <span class="select-menu-item-text">#{_item.name}</span>
                                        <a:attachQueue requestDelay="0"/>
                                    </a:commandLink>
                                </a:repeat>






                                <a:commandLink onclick="moreBefor(); moreResult(); event.stopPropagation(); return false;"
                                               styleClass="select-menu-item last-visible"
                                               rendered="#{sectionSelectList.nextExists}">


                                    <span class="select-menu-item-icon octicon octicon-check"></span>
                                    <span class="select-menu-item-text">#{messages.More}</span>
                                    <a:attachQueue requestDelay="0"/>
                                </a:commandLink>

                            </a:outputPanel>

                        </a:outputPanel>

                    </div>
                </div>
            </div>


            <a:outputPanel id="projectSelectInputs">



                <a:outputPanel rendered="#{not empty houseStepSelect.selectSection}">


                    <h:selectOneMenu value="#{houseStepSelect.selectProjectId}"
                                     p:data-header="#{messages.projectSelect}"
                                     styleClass="selectpicker edit-select form-control">
                        <s:selectItems value="#{houseStepSelect.selectSection.projectList}"
                                       var="_project" itemValue="#{_project.id}"
                                       label="#{_project.name}"
                                       noSelectionLabel="#{messages.projectSelect}"/>

                        <a:ajax event="valueChange" render="buildSelectInput" listener="#{buildHome.clearInstance}">
                            <a:attachQueue requestDelay="0"/>
                        </a:ajax>
                    </h:selectOneMenu>



                </a:outputPanel>
            </a:outputPanel>


        </a:outputPanel>
    </div>

    </ui:define>

</ui:composition>