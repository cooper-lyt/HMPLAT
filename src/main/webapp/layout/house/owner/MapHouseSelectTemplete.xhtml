<!DOCTYPE composition PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
        "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<ui:composition xmlns="http://www.w3.org/1999/xhtml"
                xmlns:s="http://jboss.org/schema/seam/taglib"
                xmlns:ui="http://java.sun.com/jsf/facelets"
                xmlns:h="http://java.sun.com/jsf/html"
                xmlns:a="http://richfaces.org/a4j" xmlns:r="http://richfaces.org/rich"
                xmlns:f="http://java.sun.com/jsf/core"
                xmlns:dh="http://www.dgsoft.com/jsf/html"
                xmlns:c="http://java.sun.com/jsp/jstl/core"
                xmlns:p="http://xmlns.jcp.org/jsf/passthrough"
                template="HouseSelectTemplete.xhtml">


    <ui:define name="h-data-context">
        <a:outputPanel layout="block" style="width: 100%; height: 100%" ajaxRendered="true">

              <a:outputPanel >




                <div style="position: absolute; left: 171px; top: 50px; width: 50px; height: 50px; border-bottom: 2px solid #ddd;"/>

                <div class="grid-map map-thead map-col-thead">
                    <table class="map-col-thead-table" width="#{ownerBuildGridMap.curMap.unitColList.size * 90}px ">
                        <a:repeat value="#{ownerBuildGridMap.curMap.unitColList}" var="_col">
                            <col/>
                        </a:repeat>
                        <tr>
                            <a:repeat value="#{ownerBuildGridMap.curMap.houseGridUnitList}" var="_unit">
                                <th colspan="#{_unit.colspan}">
                                    #{_unit.title}
                                </th>
                            </a:repeat>
                        </tr>
                    </table>
                </div>

                <div class="grid-map map-thead map-row-thead" >
                    <table class="map-row-thead-table" >
                        <a:repeat value="#{ownerBuildGridMap.curMap.gridRowList}" var="_floor">
                            <tr>

                                <th>
                                    #{_floor.title}
                                </th>

                            </tr>

                        </a:repeat>
                    </table>
                </div>

                <div class="grid-map map-context">
                    <table class="map-context-table" width="#{ownerBuildGridMap.curMap.unitColList.size * 90}px">
                        <thead>
                        <a:repeat value="#{ownerBuildGridMap.curMap.unitColList}" var="_col">
                            <col/>
                        </a:repeat>
                        </thead>
                        <tbody>

                        <a:repeat value="#{ownerBuildGridMap.curMap.gridRowList}" var="_floor">
                            <tr>
                                <a:repeat value="#{_floor.gridBlockList}" var="_cell">
                                    <td colspan="#{_cell.colspan}"
                                        rowspan="#{_cell.rowspan}" height="#{_cell.rowspan * 90}px">

                                        <a:outputPanel layout="block" styleClass="house-info" rendered="#{not empty _cell.house}" ondblclick="houseClick('#{_cell.house.houseCode}')">
                                            <div class="#{_cell.house.masterStatus}" >
                                                <div class="house-info-context">
                                                    <ul >
                                                        <li><ui:insert name="houseTitle"><h2>#{_cell.house.houseOrder}  </h2> </ui:insert> </li>
                                                        <li><h:outputText style="color: #666" value="#{_cell.house.houseArea}"><f:convertNumber pattern="#0.000"/></h:outputText></li>
                                                        <li><h:outputText style="color: #888" value="#{_cell.house.businessHouseOwner.personName}" rendered="#{not empty _cell.house.businessHouseOwner}"/></li>
                                                    </ul>
                                                </div>
                                                <div style="float: left">
                                                    <a:outputPanel styleClass=" icon-lock" rendered="#{_cell.locked}">

                                                    </a:outputPanel>
                                                </div>
                                                <div class="house-status" >
                                                    <a:outputPanel styleClass="label" rendered="#{not empty _cell.house.masterStatus}">
                                                        #{messages[_cell.house.masterStatus.name()]}
                                                    </a:outputPanel>
                                                </div>
                                            </div>


                                        </a:outputPanel>

                                    </td>
                                </a:repeat>
                            </tr>
                        </a:repeat>
                        </tbody>
                    </table>
                </div>

            </a:outputPanel>
            <h:outputScript>
                $(document).ready(
                function () {
                $(".map-context").scroll(function() {

                $(".map-col-thead").scrollTo($('.map-context').scrollLeft(),0)
                $(".map-row-thead").scrollTo($('.map-context').scrollTop(),0);

                });
                }
                );
            </h:outputScript>

            <h:outputStylesheet>

                /*,OWNERED,SALE_REGISTER,
                DIVERT_REGISTER,SALE_MORTGAGE_REGISTER,DIVERT_MORTGAGE_REGISTER,
                PLEDGE,PROJECT_PLEDGE,DIFFICULTY,DECLARE_CANCEL,COURT_CLOSE,DESTORY;*/



                .house-info .house-status{
                    float: right;
                    min-height: 17px;
                    max-height: 17px;
                    height: 17px;
                }




                .map-thead{
                    position: absolute;  overflow: hidden;
                }



                .map-col-thead{
                    top: 50px; left: 221px; right: #{rightWidth}; height: 50px;
            }

            .map-row-thead{
                top:100px; left: 171px; bottom: 0; width: 50px;
            }

            .map-row-thead th{
                border-left: 0 !important;
                border-right: 2px solid #e5e5e5;
                height: 90px;
                width: 49px;
            }

            .map-col-thead th{
                border-top: 0 !important;
                border-bottom: 2px solid #e5e5e5 !important;

                height: 49px;
                width: 90px;
            }

            .grid-map table{
                table-layout: fixed;
            }

            .grid-map col{
                width: 90px;
            }

            .grid-map td, .grid-map th{
                border: 1px solid #ddd;
                vertical-align: middle;
                text-align: center;
                white-space:nowrap;
                overflow:hidden;text-overflow:ellipsis;
            }

            .grid-map td:hover{
                background-color: #f5f9fc;
                cursor: pointer;
            }

            .map-context{
                position: absolute; top:100px; left: 221px;bottom: 0; right: #{rightWidth};overflow: auto
            }

            .house-info-context{
                min-height: 63px;
                max-height: 63px;
                height: 63px;
            }

            .house-info{
                padding: 2px;
                width: 100%;
                height: 100%;
                vertical-align: middle;
                text-align: center;
            }

            .house-info ul{
                list-style: none;
            }

            .house-info li{
                min-height: 20px;
                white-space:nowrap;

            }

            .house-info li h2{
                margin: 3px 0;
                font-size: 19px;
                color: #337ab7;
            }



            </h:outputStylesheet>

            <ui:insert name="contextRight"/>



        </a:outputPanel>



    </ui:define>


</ui:composition>