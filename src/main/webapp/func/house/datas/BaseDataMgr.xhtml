<!DOCTYPE composition PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
        "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<ui:composition xmlns="http://www.w3.org/1999/xhtml"
                xmlns:s="http://jboss.org/schema/seam/taglib"
                xmlns:ui="http://java.sun.com/jsf/facelets"
                xmlns:h="http://java.sun.com/jsf/html"
                xmlns:a="http://richfaces.org/a4j" xmlns:rich="http://richfaces.org/rich"
                xmlns:f="http://java.sun.com/jsf/core"
                xmlns:dh="http://www.dgsoft.com/jsf/html"
                template="/layout/template-data.xhtml">
    <ui:define name="head-right">
        <h:form styleClass="search_repos">
            <div class="flex-table search-form-fluid">
                <div class="flex-table-item flex-table-item-primary">
                    <div class="input-group input-block">
                        <h:inputText styleClass="form-control" value="#{baseMapDataMgr.oneCondition}"/>

                        <div class="input-group-btn">

                            <h:selectOneMenu styleClass="selectpicker select-menu-btn"
                                             value="#{baseMapDataMgr.oneSearchType}">
                                <s:selectItems value="#{baseMapDataMgr.commonTypes}" var="_item"
                                               itemValue="#{_item}" noSelectionLabel="#{messages.allConditionCategory}"
                                               label="#{messages[_item.name()]}"/>

                                <s:convertEnum/>
                            </h:selectOneMenu>


                        </div>
                        <!-- /btn-group -->
                    </div>
                    <!-- /input-group -->
                </div>
                <div class="flex-table-item">
                    <h:commandButton styleClass="button" action="#{baseMapDataMgr.searchByOne}"
                                     value="#{messages.Search}">
                    </h:commandButton>
                </div>
            </div>
        </h:form>
    </ui:define>

    <ui:decorate template="/layout/edit-modalpanel.xhtml">
        <ui:param name="panelId" value="developerEditPanel"/>
        <ui:param name="panelTitle" value="#{messages.create}#{' '}#{messages.Developer}"/>
        <s:decorate id="developerIdField" template="/layout/edit-big.xhtml">
            <ui:define name="label">
                #{messages.Developer_id}
            </ui:define>
            <h:inputText value="#{developerHome.instance.id}">

            </h:inputText>
        </s:decorate>
        <ui:define name="actionButtons">
            <button type="button" class="button default" data-dismiss="modal">
                <span class="glyphicon glyphicon-floppy-remove"/>
                #{messages.abort}</button>
            <a:commandLink styleClass="button submit primary" render="developerEditPanel_inputs">

                <span class="glyphicon glyphicon-floppy-disk"/>
                #{messages.save}
            </a:commandLink>
        </ui:define>
    </ui:decorate>


    <ui:decorate template="/layout/edit-modalpanel.xhtml">
        <ui:param name="panelId" value="districtEditPanel"/>
        <ui:param name="panelTitle" value="#{messages.create}#{' '}#{messages.District}"/>


        <s:decorate id="distractIdField" styleClass="form left" template="/layout/edit-big.xhtml">
            <ui:define name="label">
                #{messages.District_id}
            </ui:define>
            <ui:param name="for" value="districtIdInput"/>
            <ui:param name="status" value="districtIdStatus"/>
            <h:inputText id="districtIdInput" required="true" styleClass="form-control" maxlength="9"
                         label="#{messages.District_id}"
                         value="#{districtHome.instance.id}" disabled="#{districtHome.managed}"
                         valueChangeListener="#{districtHome.verifyIdAvailable}">
                <f:validateRequired/>
                <a:ajax event="change" render="distractIdField" status="districtIdStatus"/>
            </h:inputText>

        </s:decorate>
        <span class="slash">/</span>


        <s:decorate id="shortNameField" styleClass="form left" template="/layout/edit-big.xhtml">
            <ui:define name="label">
                #{messages.District_shortName}
            </ui:define>
            <ui:param name="for" value="shortNameFieldInput"/>
            <h:inputText id="shortNameFieldInput" required="true" styleClass="form-control" maxlength="10"
                         label="#{messages.District_shortName}" size="10"
                         value="#{districtHome.instance.shortName}">
                <f:validateRequired/>
                <rich:validator/>
            </h:inputText>
        </s:decorate>

        <div style="clear: both"/>
        <s:decorate id="distractNameField" styleClass="form-group" template="/layout/edit-big.xhtml">
            <ui:define name="label">
                #{messages.District_name}
            </ui:define>
            <ui:param name="for" value="districtNameInput"/>
            <ui:param name="status" value="districtNameStatus"/>
            <h:inputText id="districtNameInput" required="true" styleClass="form-control" maxlength="100"
                         label="#{messages.District_name}" unique="name"
                         value="#{districtHome.instance.name}"
                         valueChangeListener="#{districtHome.verifyUniqueAvailable}">
                <f:validateRequired/>
                <a:ajax event="change" render="distractNameField" status="districtNameStatus"/>
            </h:inputText>
        </s:decorate>
        <ui:define name="actionButtons">
            <button type="button" class="button default" data-dismiss="modal">
                <span class="glyphicon glyphicon-floppy-remove"/>
                #{messages.abort}</button>
            <a:commandLink styleClass="button submit primary" render="districtEditPanel_inputs,dataContainer"
                           data="#{districtHome.lastState}"
                           oncomplete="if (event.data == 'persisted'){$('#districtEditPanel').modal('hide')}"
                           action="#{districtHome.persist}">

                <span class="glyphicon glyphicon-floppy-disk"/>
                #{messages.save}
            </a:commandLink>
        </ui:define>
    </ui:decorate>


    <a:outputPanel layout="block" id="dataContainer" styleClass="columns">
        <div class="column one-fourth codesearch-aside">
            <nav class="menu">
                <s:link styleClass="menu-item #{((empty baseMapDataMgr.dataType) or (baseMapDataMgr.dataType eq 'PROJECT_MGR')) ? 'selected' : ''}"
                        propagation="none">
                    #{messages.Project}
                    <h:outputText styleClass="counter" value="#{projectList.resultCount}">
                        <f:convertNumber type="number" groupingUsed="true"/>
                    </h:outputText>
                    <f:param name="dataTypeName" value="PROJECT_MGR"/>
                </s:link>
                <s:link styleClass="menu-item #{(baseMapDataMgr.dataType eq 'SECTION_MGR') ? 'selected' : ''}"
                        propagation="none">
                    #{messages.Section}
                    <h:outputText styleClass="counter" value="#{sectionList.resultCount}">
                        <f:convertNumber type="number" groupingUsed="true"/>
                    </h:outputText>
                    <f:param name="dataTypeName" value="SECTION_MGR"/>
                </s:link>
                <s:link styleClass="menu-item #{(baseMapDataMgr.dataType eq 'DISTRICT_MGR') ? 'selected' : ''}"
                        propagation="none">
                    #{messages.District}
                    <h:outputText styleClass="counter" value="#{districtList.resultCount}">
                        <f:convertNumber type="number" groupingUsed="true"/>
                    </h:outputText>
                    <f:param name="dataTypeName" value="DISTRICT_MGR"/>
                </s:link>
                <s:link styleClass="menu-item #{(baseMapDataMgr.dataType eq 'DEVELOPER_MGR') ? 'selected' : ''}"
                        propagation="none">
                    #{messages.Developer}
                    <h:outputText styleClass="counter" value="#{developerList.resultCount}">
                        <f:convertNumber type="number" groupingUsed="true"/>
                    </h:outputText>
                    <f:param name="dataTypeName" value="DEVELOPER_MGR"/>
                </s:link>
            </nav>
        </div>
        <div class="column three-fourths codesearch-results">

            <s:div styleClass="blankslate" rendered="#{baseMapDataMgr.emptyResult}">
                <span class="mega-octicon octicon-search"></span>

                <h3>#{messages.EmptyResult}</h3>

                <p>  #{messages.YouCan}#{' '}
                    <a:commandLink value="#{messages.create}"
                                   oncomplete="$('#districtEditPanel').modal({backdrop: 'static'})"
                                   render="districtEditPanel_form"
                                   rendered="#{(baseMapDataMgr.dataType eq 'DISTRICT_MGR')}">
                        <a:attachQueue requestDelay="0"/>
                        <a:param value="" assignTo="#{districtHome.id}"/>
                    </a:commandLink>
                    <a:commandLink value="#{messages.create}"
                                   oncomplete="$('#developerEditPanel').modal({backdrop: 'static'})"
                                   render="developerEditPanel_form"
                                   rendered="#{(baseMapDataMgr.dataType eq 'DEVELOPER_MGR')}">
                        <a:attachQueue requestDelay="0"/>
                        <a:param value="" assignTo="#{developerHome.id}"/>
                    </a:commandLink>
                    <s:link value="#{messages.create}" action="#{baseMapDataMgr.createNew}"
                            rendered="#{(empty baseMapDataMgr.dataType) or (baseMapDataMgr.dataType eq 'PROJECT_MGR') or (baseMapDataMgr.dataType eq 'SECTION_MGR')}"/>#{' '} #{messages.Or}  #{messages.Try} #{' '}
                    <s:link value="#{messages.AvancedSearch}"/></p>
            </s:div>

            <a:outputPanel rendered="#{not baseMapDataMgr.emptyResult}">

                <div class="repo-list">
                    <h:dataTable id="projectDataTable" value="#{projectList.resultList}" var="_item"
                                 styleClass="table table-striped table-hover table-floatThead"
                                 rendered="#{(empty baseMapDataMgr.dataType) or (baseMapDataMgr.dataType eq 'PROJECT_MGR')}">


                        <h:column>
                            <f:facet name="header">
                                <ui:include src="/layout/a4jSort.xhtml">
                                    <ui:param name="entityList" value="#{projectList}"/>
                                    <ui:param name="propertyLabel" value="#{messages.Project_id}"/>
                                    <ui:param name="propertyPath" value="project.id"/>
                                </ui:include>
                            </f:facet>
                            <s:link value="#{_item.id}" target="_blank" view="/func/house/datas/ProjectView.xhtml">
                                <f:param name="projectId" value="#{_item.id}"/>
                            </s:link>
                        </h:column>

                        <h:column>
                            <f:facet name="header">
                                <ui:include src="/layout/a4jSort.xhtml">
                                    <ui:param name="entityList" value="#{projectList}"/>
                                    <ui:param name="propertyLabel" value="#{messages.Project_name}"/>
                                    <ui:param name="propertyPath" value="project.name"/>
                                </ui:include>
                            </f:facet>
                            #{_item.name}
                        </h:column>

                        <h:column>
                            <f:facet name="header">
                                <ui:include src="/layout/a4jSort.xhtml">
                                    <ui:param name="entityList" value="#{projectList}"/>
                                    <ui:param name="propertyLabel" value="#{messages.Developer}"/>
                                    <ui:param name="propertyPath" value="project.developer.name"/>
                                </ui:include>
                            </f:facet>
                            #{_item.developer.name}
                        </h:column>

                        <h:column>
                            <f:facet name="header">
                                <ui:include src="/layout/a4jSort.xhtml">
                                    <ui:param name="entityList" value="#{projectList}"/>
                                    <ui:param name="propertyLabel" value="#{messages.Project_area}"/>
                                    <ui:param name="propertyPath" value="project.area"/>
                                </ui:include>
                            </f:facet>
                            <h:outputText value="#{_item.area}">
                                <f:convertNumber pattern="#0.###"/>
                            </h:outputText>
                        </h:column>

                        <h:column>
                            <f:facet name="header">
                                #{messages.Project_address}
                            </f:facet>
                            <ui:include src="/layout/long-text-display.xhtml">
                                <ui:param name="value" value="#{_item.address}"/>
                                <ui:param name="size" value="8"/>
                            </ui:include>

                        </h:column>

                        <h:column>
                            <f:facet name="header">
                                <ui:include src="/layout/a4jSort.xhtml">
                                    <ui:param name="entityList" value="#{projectList}"/>
                                    <ui:param name="propertyLabel" value="#{messages.Project_state}"/>
                                    <ui:param name="propertyPath" value="project.state"/>
                                </ui:include>
                            </f:facet>
                            #{messages[_item.state.name()]}
                        </h:column>

                        <h:column style="text-align: center; width: 60px;">

                            <a:commandLink action="#{projectHome.remove}" title="#{messages.delete}"
                                           execute="@this" immediate="true" render="dataListResult"
                                           onclick="JavaScript:if(confirm('#{messages.deleteConfirm}')){}else{return false;}">
                                <span class="glyphicon glyphicon-remove"/>
                                <a:attachQueue requestDelay="0"/>
                                <a:param value="#{_item.id}" assignTo="#{projectHome.id}"/>
                            </a:commandLink>


                            #{' '}
                            <s:link>
                                <span class="glyphicon glyphicon-pencil"/>
                            </s:link>

                            #{' '}

                            <s:link target="_blank" view="/func/house/datas/ProjectBuildEdit.xhtml">
                                <f:param name="projectId" value="#{_item.id}"/>
                                <span class="glyphicon glyphicon-th"/>
                            </s:link>
                        </h:column>

                    </h:dataTable>

                    <h:dataTable id="sectionDataTable" value="#{sectionList.resultList}" var="_item"
                                 styleClass="table table-striped table-hover table-floatThead"
                                 rendered="#{baseMapDataMgr.dataType eq 'SECTION_MGR'}">
                        <h:column>
                            <f:facet name="header">
                                #{messages.Id}
                            </f:facet>
                            #{_item.id}
                        </h:column>
                        <h:column>
                            <f:facet name="header">
                                #{messages.District}
                            </f:facet>
                            #{_item.district.name}
                        </h:column>
                        <h:column>
                            <f:facet name="header">
                                #{messages.Name}
                            </f:facet>
                            #{_item.name}
                        </h:column>
                        <h:column>
                            <f:facet name="header">
                                #{messages.Section_address}
                            </f:facet>
                            #{_item.address}
                        </h:column>
                        <h:column>
                            <a:commandLink action="#{projectHome.remove}" title="#{messages.delete}"
                                           execute="@this" immediate="true" render="dataListResult"
                                           onclick="JavaScript:if(confirm('#{messages.deleteConfirm}')){}else{return false;}">
                                <span class="glyphicon glyphicon-remove"/>
                                <a:attachQueue requestDelay="0"/>
                                <a:param value="#{_item.id}" assignTo="#{projectHome.id}"/>
                            </a:commandLink>


                            #{' '}
                            <s:link>
                                <span class="glyphicon glyphicon-pencil"/>
                            </s:link>
                        </h:column>
                    </h:dataTable>


                    <h:dataTable id="developerDataTable" value="#{developerList.resultList}" var="_item"
                                 styleClass="table table-striped table-hover table-floatThead"
                                 rendered="#{baseMapDataMgr.dataType eq 'DEVELOPER_MGR'}">

                        <h:column>
                            <f:facet name="header">
                                #{messages.Id}
                            </f:facet>
                            <h:outputText styleClass="#{_item.destroyed ? 'delete-data' : ''}" value="#{_item.id}">
                            </h:outputText>
                        </h:column>
                        <h:column>
                            <f:facet name="header">
                                #{messages.Name}
                            </f:facet>
                            <h:outputText styleClass="#{_item.destroyed ? 'delete-data' : ''}"
                                          value="#{_item.name}">
                            </h:outputText>
                        </h:column>
                        <h:column>
                            <a:commandLink action="#{projectHome.remove}" title="#{messages.delete}"
                                           execute="@this" immediate="true" render="dataListResult"
                                           onclick="JavaScript:if(confirm('#{messages.deleteConfirm}')){}else{return false;}">
                                <span class="glyphicon glyphicon-remove"/>
                                <a:attachQueue requestDelay="0"/>
                                <a:param value="#{_item.id}" assignTo="#{projectHome.id}"/>
                            </a:commandLink>


                            #{' '}
                            <s:link>
                                <span class="glyphicon glyphicon-pencil"/>
                            </s:link>
                        </h:column>
                    </h:dataTable>

                    <h:outputStylesheet>
                        .district-id-column {
                            width: 90px;
                        }

                        .district-short-name-column {
                            width: 60px;
                        }

                        .disistrict-action-column {
                            width: 160px;
                        }
                    </h:outputStylesheet>

                    <h:dataTable id="districtDataTable" value="#{districtList.resultList}" var="_item"
                                 styleClass="table table-striped table-hover table-floatThead result-data-table"
                                 columnClasses="district-id-column,,district-short-name-column,disistrict-action-column"
                                 headerClass="table-tools-header"
                                 rendered="#{baseMapDataMgr.dataType eq 'DISTRICT_MGR'}">

                        <f:facet name="header">


                            <div class="select-menu">
                                <div class="btn-group btn-group-sm">

                                    <a:commandLink styleClass="btn btn-success"
                                                   oncomplete="$('#districtEditPanel').modal({backdrop: 'static'})"
                                                   render="districtEditPanel_form"
                                                   aria-label="#{messages.create}#{messages.District}">
                                        <a:param value="" assignTo="#{districtHome.id}"/>
                                        <a:attachQueue requestDelay="0"/>
                                        <span class="octicon octicon-plus"/>
                                    </a:commandLink>

                                    <div class="btn-group btn-group-sm">
                                        <ui:decorate template="/layout/dropdown-actions.xhtml">
                                            <ui:param name="caption" value="#{messages[districtList.orderColumn]}"/>
                                            <ui:define name="caption">
                                                <i>#{messages.SortBy}:</i>
                                                <span style="">#{messages[districtList.orderColumn]}</span>
                                            </ui:define>
                                            <ui:param name="menuTitle" value="#{messages.SortOption}"/>

                                            <a:repeat value="#{districtList.sortColumns}" var="_col">
                                                <s:link styleClass="select-menu-item #{(districtList.orderColumn eq _col) ? 'selected': ''}">
                                                    <f:param name="districtSort" value="#{_col}"/>
                                                    <span class="select-menu-item-icon octicon octicon-check"></span>
                                                    <span class="select-menu-item-text">#{messages[_col]}</span>
                                                </s:link>
                                            </a:repeat>
                                        </ui:decorate>
                                    </div>
                                </div>
                            </div>


                            <h3>
                                #{messages.SerachResultCount}#{' '}
                                <h:outputText value="#{districtList.resultCount}">
                                    <f:convertNumber type="number" groupingUsed="true"/>
                                </h:outputText>
                                #{''}#{messages.SerachResultCountPrefx}
                            </h3>
                        </f:facet>

                        <h:column headerClass="table-header">
                            <f:facet name="header">
                                #{messages.Id}
                            </f:facet>
                            #{_item.id}
                        </h:column>
                        <h:column headerClass="table-header">
                            <f:facet name="header">
                                #{messages.Name}
                            </f:facet>
                            #{_item.name}
                        </h:column>
                        <h:column headerClass="table-header">
                            <f:facet name="header">
                                #{messages.District_shortName}
                            </f:facet>
                            #{_item.shortName}
                        </h:column>
                        <h:column headerClass="table-header">
                            <f:facet name="header">

                                <div class="right">

                                    <dh:switch value="#{districtList.orderAsc}"
                                               data-on-text="&lt;span class='glyphicon glyphicon-sort-by-attributes'/&gt;"
                                               data-off-text="&lt;span class='glyphicon glyphicon-sort-by-attributes-alt'/&gt;"
                                               data-label-text="&lt;span class='glyphicon'&gt;&nbsp;&lt;/span&gt;"
                                               data-size="mini" styleClass="js-switch"/>

                                </div>
                            </f:facet>

                            <div class="table-actions right">
                                <a:commandLink styleClass="table-action">
                                    <span class="octicon octicon-pencil"/>
                                    #{messages.edit}
                                    <a:attachQueue requestDelay="0"/>
                                    <a:param value="#{_item.id}" assignTo="#{districtHome.id}"/>
                                </a:commandLink>

                                <a:commandLink styleClass="table-action"
                                               action="#{projectHome.remove}" title="#{messages.delete}"
                                               execute="@this" immediate="true" render="dataListResult"
                                               onclick="JavaScript:if(confirm('#{messages.deleteConfirm}')){}else{return false;}">
                                    <span class="glyphicon glyphicon-remove"/>
                                    #{messages.delete}
                                    <a:attachQueue requestDelay="0"/>
                                    <a:param value="#{_item.id}" assignTo="#{projectHome.id}"/>
                                </a:commandLink>

                            </div>

                        </h:column>
                    </h:dataTable>

                </div>
                <div class="paginate-container">
                    <a:outputPanel
                            rendered="#{(empty baseMapDataMgr.dataType) or baseMapDataMgr.dataType eq 'PROJECT_MGR'}">
                        <ui:include src="/layout/pages.xhtml">
                            <ui:param name="entityList" value="#{projectList}"/>
                        </ui:include>
                    </a:outputPanel>
                    <a:outputPanel rendered="#{baseMapDataMgr.dataType eq 'DISTRICT_MGR'}">
                        <ui:include src="/layout/pages.xhtml">
                            <ui:param name="entityList" value="#{districtList}"/>
                        </ui:include>
                    </a:outputPanel>
                    <a:outputPanel rendered="#{baseMapDataMgr.dataType eq 'DEVELOPER_MGR'}">
                        <ui:include src="/layout/pages.xhtml">
                            <ui:param name="entityList" value="#{developerList}"/>
                        </ui:include>
                    </a:outputPanel>
                    <a:outputPanel rendered="#{baseMapDataMgr.dataType eq 'SECTION_MGR'}">
                        <ui:include src="/layout/pages.xhtml">
                            <ui:param name="entityList" value="#{sectionList}"/>
                        </ui:include>
                    </a:outputPanel>
                </div>
                <p class="search-foot-note"></p>
            </a:outputPanel>
        </div>
    </a:outputPanel>

</ui:composition>