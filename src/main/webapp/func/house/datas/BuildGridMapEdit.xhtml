<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
        "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<html xmlns="http://www.w3.org/1999/xhtml"
      xmlns:ui="http://java.sun.com/jsf/facelets"
      xmlns:f="http://java.sun.com/jsf/core"
      xmlns:h="http://java.sun.com/jsf/html"
      xmlns:p="http://xmlns.jcp.org/jsf/passthrough"
      xmlns:a="http://richfaces.org/a4j" xmlns:r="http://richfaces.org/rich"
      xmlns:s="http://jboss.org/schema/seam/taglib">
<f:view
        contentType="text/html">

    <h:head>
        <meta http-equiv="Content-Type" content="text/html; charset=UTF-8"/>
        <!-- meta http-equiv="X-UA-Compatible" content="IE=8"/-->
        <title>#{messages.mainTitle}</title>
        <link rel="shortcut icon" href="#{request.contextPath}/favicon.ico"/>

        <ui:insert name="head"/>
    </h:head>


    <h:body onload="#{r:component('idleHousePopup')}.show();" >

        <h:outputStylesheet library="bootstrap" name="/css/bootstrap.min.css"/>
        <h:outputStylesheet library="bootstrap-select" name="/css/bootstrap-select.min.css"/>
        <h:outputStylesheet library="bootstrap" name="/css/bootstrap-theme.min.css"/>
        <h:outputStylesheet library="bootstrap-switch" name="/css/bootstrap3/bootstrap-switch.min.css"/>
        <h:outputStylesheet library="bootstrap-datepicker" name="/css/bootstrap-datepicker3.min.css"/>

        <h:outputStylesheet library="fontawesome" name="font-awesome.min.css"/>
        <h:outputStylesheet name="other.css"/>
        <h:outputStylesheet library="github" name="/css/octicons.css"/>




        <s:div>
            <a:queue requestDelay="0" ignoreDupResponses="true"/>

            <h:form id="toolbar">

            <nav class="navbar navbar-default navbar-fixed-top">
                <div class="container-fluid">
                    <!-- Brand and toggle get grouped for better mobile display -->
                    <div class="navbar-header">
                        <button type="button" class="navbar-toggle collapsed" data-toggle="collapse"
                                data-target="#bs-example-navbar-collapse-1">
                            <span class="sr-only">Toggle navigation</span>
                            <span class="icon-bar"></span>
                            <span class="icon-bar"></span>
                            <span class="icon-bar"></span>
                        </button>
                        <h:graphicImage value="/img/logo-icon.png" styleClass="navbar-brand"/>
                    </div>

                    <!-- Collect the nav links, forms, and other content for toggling -->
                    <div class="collapse navbar-collapse" id="bs-example-navbar-collapse-1">
                        <ul class="nav navbar-nav">
                            <li>

                                <a:commandLink
                                        immediate="true" execute="@this"
                                        oncomplete="#{r:component('updateFilePopup')}.show();">
                                    <span class="icon-folder-open icon-large"/>
                                    #{(empty buildHome.buildGridPages) ? messages.UploadGridXML : messages.AddGridXML}
                                    <a:attachQueue requestDelay="0"/>
                                    <a:param value="#{false}" assignTo="#{buildGridMapHome.replaceGridMap}"/>
                                </a:commandLink>


                            </li>
                            <li>
                                <a:commandLink immediate="true" execute="@this"
                                               oncomplete="#{r:component('updateFilePopup')}.show();">
                                    <span class="icon-folder-open-alt icon-large"/>
                                    #{messages.UpdateGridXML}

                                    <a:attachQueue requestDelay="0"/>
                                    <a:param value="#{true}" assignTo="#{buildGridMapHome.replaceGridMap}"/>
                                </a:commandLink>

                            </li>

                            <li>
                                <a:commandLink
                                        onclick="$('#deletePageConfirm').modal('show'); return false;">
                                    <span class="icon-remove icon-large"/>

                                    #{messages.DeletePage}
                                </a:commandLink>
                            </li>

                            <li>



                                <a:commandLink status="processWaiting"
                                               action="#{buildGridMapHome.saveGridMap}"
                                               render="grid_map,idle">
                                    <span class="icon-save icon-large"/>
                                    #{messages.save}
                                    <a:attachQueue requestDelay="0"/>
                                </a:commandLink>



                            </li>


                            <li class="dropdown">
                                <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button"
                                   aria-expanded="false">#{buildGridMapHome.instance.order} . #{buildGridMapHome.instance.name} <span class="caret"></span></a>
                                <ul class="dropdown-menu" role="menu">
                                    <a:repeat value="#{buildHome.buildGridPages}" var="_page">
                                        <li role="presentation" class="#{(_page.order eq buildGridMapHome.instance.order) ? 'disabled' : ''}">
                                            <a:commandLink  p:role="menuitem" p:tabindex="-1" immediate="true" execute="@this" status="processWaiting"
                                                           render="grid_map,toolbar" action="#{buildGridMapHome.toPage}">
                                                <span class="menu-icon">
#{_page.order}
                                                </span>
                                                #{_page.name}
                                                <a:attachQueue requestDelay="0"/>
                                                <a:param value="#{_page.order}"
                                                         assignTo="#{buildGridMapHome.gotoPage}"/>
                                            </a:commandLink>
                                        </li>
                                    </a:repeat>
                                </ul>
                            </li>
                        </ul>

                        <ul class="nav navbar-nav navbar-right">
                            <li>
                                <s:link onclick="JavaScript:if(confirm('#{messages.ExitGridMapEditConfirm}')){}else{return false;}"
                                        propagation="end"
                                        view="/func/house/datas/ProjectView.xhtml"
                                        value="#{messages.exit}">
                                    <f:param name="projectId" value="#{buildHome.instance.project.id}"/>
                                </s:link>


                            </li>

                        </ul>
                    </div>
                    <!-- /.navbar-collapse -->
                </div>
                <!-- /.container-fluid -->
            </nav>

            </h:form>



            <div class="container-fluid" style="margin-top: 50px;">

                    <ui:decorate template="/layout/delete_confirm_dialog.xhtml">
                        <ui:param name="panelId" value="deletePageConfirm"/>

                        <ui:define name="panelBody">
                            <s:div >
                                <h:outputText value="#{messages.HowOperDeleteGridHouse}"
                                              style="font-size: 1.2em; font-weight: bold;"/>
                                <br/>
                                <h:outputText value="#{messages.DeleteAllHouseDescript}" style="color:#b92c28;"/>
                                <br/>
                                <h:outputText value="#{messages.IdleAllHouseDescript}" style="color:#e38d13;"/>
                            </s:div>
                        </ui:define>

                        <a:commandButton action="#{buildGridMapHome.deleteGridMapAndHouse}"
                                         styleClass="btn btn-danger"
                                         render="grid_map,idle,toolbar" status="processWaiting"
                                         onclick="$('#deletePageConfirm').modal('hide')"
                                         value="#{messages.BuildMapAction_delete}" execute="@this"
                                         immediate="true">
                            <a:attachQueue requestDelay="0"/>
                        </a:commandButton>


                        <a:commandButton action="#{buildGridMapHome.deleteGridMapIdleHouse}"
                                         value="#{messages.BuildMapAction_idle}"
                                         styleClass="btn btn-warning"
                                         onclick="$('#deletePageConfirm').modal('hide');"
                                         status="processWaiting" immediate="true"
                                         execute="@this" render="grid_map,idle,toolbar">
                            <a:attachQueue requestDelay="0"/>
                        </a:commandButton>

                        <a:commandButton immediate="true" styleClass="btn btn-default"
                                         execute="@this" value="#{messages.cancel}"
                                         onclick="$('#deletePageConfirm').modal('hide'); return false;">
                        </a:commandButton>
                    </ui:decorate>

                    <r:popupPanel id="deletePageConfirm" width="300" height="140" modal="true" resizeable="false">

                        <f:facet name="header">
                            <h:outputText value="#{messages.deleteConfirm}"/>
                        </f:facet>

                        <f:facet name="controls">
                            <a:commandButton immediate="true"
                                             execute="@this" image="/img/close.png"
                                             onclick="#{r:component('deletePageConfirm')}.hide(); return false;">
                            </a:commandButton>
                        </f:facet>
                        <a:outputPanel>


                            <h:panelGrid columns="1" style="width: 100%; text-align: right">
                                <a:outputPanel id="#{panelId}_buttons">



                                </a:outputPanel>
                            </h:panelGrid>
                        </a:outputPanel>
                    </r:popupPanel>




                <h:outputStylesheet>



                    .panelc {
                        width: 25%;
                    }

                    .footerClass {
                        text-align: center;
                        padding-top: 5px;
                    }

                    .rf-ind-drag {
                        font-size: 13px;
                        cursor: pointer;

                        width: 100%;
                        height: 100%;
                        border: 0px solid gray;
                        padding: 0px
                    }

                    .rf-idle-drag {
                        font-size: 11px;
                        cursor: pointer;
                        width: 100%;
                        height: 100%;
                        padding: 0px;
                    }

                    .indicator-drag {
                        border: 1px solid #000000;
                        background-color: gray;
                        opacity: 0.3;
                        margin: 2px;
                        height: 64px;
                        width: 64px;
                        text-align: center;
                        background: url('#{facesContext.externalContext.requestContextPath}/img/
                house

                /
                dragHouse.png

                ') center center no-repeat;
                }

                .indicator-acpt {
                    height: 48px;
                    width: 48px;
                    border: 1px dotted green;
                    background-color: green;
                    background: url('#{facesContext.externalContext.requestContextPath}/img/
                house

                /
                dragInHouse.png

                ') center center no-repeat;
                }

                .indicator-rejt {
                    height: 48px;
                    width: 48px;
                    border: 1px dotted red;
                    background-color: red;
                    background: url('#{facesContext.externalContext.requestContextPath}/img/
                house

                /
                dragStopHouse.png

                ') center center no-repeat;
                }

                .rf-p-b {
                    width: 100%;
                    height: 100%;
                    padding: 0px;
                }

                .idle-house-con {
                    float: left;
                    width: 50px;
                    height: 50px;
                    margin: 2px;
                    text-align: center;
                    position: relative;
                }



                </h:outputStylesheet>

                <a:status id="processWaiting" name="processWaiting"
                          onstart="#{r:component('wait')}.show()"
                          onstop="#{r:component('wait')}.hide()"/> <!--  -->
                <r:popupPanel id="wait" modal="true" autosized="true" styleClass="transparent-popup"
                              moveable="false" resizeable="false" shadowDepth="0" shadowOpacity="0"  >
                    <p>      <h:graphicImage value="/img/wait-128.gif" width="64" height="64"/></p>
                    <p>#{messages.ContextLoader}...</p>


                </r:popupPanel>

                <r:messages globalOnly="true" ajaxRendered="true"/>




                <h:form>


                    <r:dragIndicator id="indicator" acceptClass="indicator-acpt" draggingClass="indicator-drag"
                                     rejectClass="indicator-rejt"/>

                    <!-- oncontextmenu="window.event.returnValue = false" -->
                    <a:outputPanel id="grid_map">

                        <a:jsFunction name="renderMap" render="grid_map,idle,toolbar" status="processWaiting"/>

                        <br/>

                        <s:div style="width: 100%;text-align: center;">
                            <r:inplaceInput value="#{buildGridMapHome.instance.name}" style="min-width: 200px;"/>
                        </s:div>


                        <br/>

                        <ui:decorate template="/layout/house/BuildGridMapTemplate.xhtml">

                            <ui:param name="tdSize" value="60"/>
                            <ui:param name="gridMap" value="#{buildGridMapHome.instance}"/>

                            <r:dropTarget id="grid_target"
                                          acceptedTypes="house block #{empty _house.house ? 'newHouse' : ''}"
                                          dropValue="#{_house}"
                                          execute="@this"
                                          status="processWaiting"
                                          dropListener="#{buildGridMapHome.processDrop}"
                                          render="grid_map,idle"/>

                            <a:outputPanel layout="block" styleClass="rf-ind-drag"
                                           rendered="#{not empty _house.house}">
                                <r:dragSource id="grid_source" type="block" dragIndicator="indicator"
                                              dragValue="#{_house}"/>
                                <a:outputPanel>
                                    <h:outputText value="#{_house.house.houseOrder}"
                                                  style="font-size: 1em; font-weight: bold;#{_house.house.validator ? 'color: #000000;' : 'color: red;' }"/>
                                    <r:tooltip styleClass="tooltip-custom-body"
                                               layout="block" mode="client"
                                               rendered="#{(not _house.house.detailsValid) or (not _house.house.orderValid)}">
                                        <s:span rendered="#{not _house.house.detailsValid}" style="white-space: normal">
                                            <h:outputText styleClass="errors" value="#{messages.HouseDetailsError}"/>

                                        </s:span>
                                        <s:span rendered="#{not _house.house.orderValid}" style="white-space: normal">
                                            <h:outputText styleClass="errors" value="#{messages.HouseOrderConflict}"/>

                                        </s:span>


                                    </r:tooltip>

                                </a:outputPanel>


                                <br/>
                                <h:outputText value="#{_house.house.houseArea}"
                                              style="font-size: 0.9em;color: #797268;">
                                    <f:convertNumber pattern="#0.000"/>
                                </h:outputText>
                                <br/>
                                <h:outputText value="#{_house.house.useArea}"
                                              style="font-size: 0.9em;color: #797268;">
                                    <f:convertNumber pattern="#0.000"/>
                                </h:outputText>

                                <r:contextMenu mode="client" showEvent="contextmenu" style="text-align: left;"
                                               popupWidth="100">
                                    <r:menuItem action="#{buildGridMapHome.deleteBlockHouse}"
                                                icon="/img/icons/delete-red.png"
                                                label="#{messages.BuildMapAction_delete}"
                                                mode="ajax" execute="@this"
                                                oncomplete="$('#removeHouseConfig').modal('show')"
                                                render="removeHouseConfig_form">
                                        <a:param name="blockId" value="#{_house.id}"
                                                 assignTo="#{buildGridMapHome.selectBlockId}"/>
                                    </r:menuItem>
                                    <r:menuItem action="#{buildGridMapHome.idleBlockHouse}"
                                                label="#{messages.BuildMapAction_idle}"
                                                status="processWaiting" icon="/img/icons/delete-blue.png"
                                                mode="ajax" execute="@this" render="grid_map,idle">
                                        <a:param name="blockId" value="#{_house.id}"
                                                 assignTo="#{buildGridMapHome.selectBlockId}"/>
                                    </r:menuItem>

                                    <r:menuItem label="#{messages.BuildMapAction_edit}" mode="ajax" execute="@this"
                                                action="#{actionExecuteState.clearState}"
                                                icon="/img/icons/info-blue.png"
                                                oncomplete="$('#editPanel').modal({show: true, backdrop: 'static'});"
                                                render="editPanel_form">
                                        <a:param name="blockId" value="#{_house.id}"
                                                 assignTo="#{buildGridMapHome.selectBlockId}"/>
                                    </r:menuItem>
                                </r:contextMenu>

                            </a:outputPanel>


                            <h:graphicImage
                                    style="height: 16px;padding: 0px;border: 0px;position: absolute;bottom: 0;left: 0;"
                                    rendered="#{(not empty _house.house) and (_house.house.lockStatus.lock)}"
                                    value="/img/house/lock.png" title="#{messages.LockDecription}"/>

                            <ui:define name="house-action">
                                <a:commandButton rendered="#{not empty _house.house}"
                                                 image="/img/icons/delete-blue.png"
                                                 render="deleteHouseConfirm_form"
                                                 oncomplete="$('#deleteHouseConfirm').modal({show: true});"
                                                 title="#{messages.BuildMapAction_delete}"
                                                 execute="@this" immediate="true">
                                    <a:param name="blockId" value="#{_house.id}"
                                             assignTo="#{buildGridMapHome.selectBlockId}"/>
                                    <a:attachQueue requestDelay="0"/>
                                </a:commandButton>

                                <a:commandButton style="padding-left: 1px; padding-right: 1px;"
                                                 image="/img/icons/info-blue.png"
                                                 action="#{actionExecuteState.clearState}"
                                                 rendered="#{not empty _house.house}"
                                                 title="#{messages.BuildMapAction_edit}"
                                                 oncomplete="$('#editPanel').modal({show: true, backdrop: 'static'});"
                                                 immediate="true" execute="@this" render="editPanel_form">
                                    <a:param name="blockId" value="#{_house.id}"
                                             assignTo="#{buildGridMapHome.selectBlockId}"/>
                                    <a:attachQueue requestDelay="0"/>
                                </a:commandButton>
                            </ui:define>


                        </ui:decorate>
                        <br/>
                        <h:dataTable style="float: right; width: 400px;"  styleClass="table table-striped table-hover table-floatThead result-data-table" value="#{buildGridMapHome.useTypeTotalList}" var="_entry"
                                     >
                            <h:column >
                                <f:facet name="header">
                                    #{messages.House_UseType}
                                </f:facet>
                                #{_entry.key.value}

                                <f:facet name="footer">
                                    #{messages.recordTotal}
                                </f:facet>
                            </h:column>

                            <h:column >
                                <f:facet name="header">
                                    #{messages.count}
                                </f:facet>
                                #{_entry.value.count}

                                <f:facet name="footer">
                                    #{buildGridMapHome.houseCount}
                                </f:facet>

                            </h:column>

                            <h:column >
                                <f:facet name="header">
                                    #{messages.House_Area}
                                </f:facet>
                                <h:outputText value="#{_entry.value.area}">
                                    <f:convertNumber pattern="#0.000"/>
                                </h:outputText>

                                <f:facet name="footer">
                                    <h:outputText value="#{buildGridMapHome.totalHouseArea}">
                                        <f:convertNumber pattern="#0.000"/>
                                    </h:outputText>

                                </f:facet>
                            </h:column>

                            <h:column >
                                <f:facet name="header">
                                    #{messages.House_UseArea}
                                </f:facet>
                                <h:outputText value="#{_entry.value.useArea}">
                                    <f:convertNumber pattern="#0.000"/>
                                </h:outputText>

                                <f:facet name="footer">
                                    <h:outputText value="#{buildGridMapHome.totalHouseUseArea}">
                                        <f:convertNumber pattern="#0.000"/>
                                    </h:outputText>

                                </f:facet>
                            </h:column>

                        </h:dataTable>
                    </a:outputPanel>


                    <div class="modal fade data-dialog " id="deleteHouseConfirm" tabindex="-1" role="dialog"
                         aria-labelledby="deleteHouseConfirm_ModalLabel"
                         aria-hidden="true">
                        <div class="modal-dialog modal-sm">
                            <div class="modal-content">
                                <div class="modal-header">

                                    <a:outputPanel id="deleteHouseConfirm_controls">

                                        <button type="button" class="close" aria-label="#{messages.close}"
                                                data-dismiss="modal">
                                            <span class="octicon octicon-remove-close" aria-hidden="true"></span>
                                            <span class="sr-only">#{messages.close}</span></button>
                                    </a:outputPanel>
                                    <a:outputPanel id="deleteHouseConfirm_title">
                                        <h2 class="facebox-header" id="deleteHouseConfirm_ModalLabel">#{messages.deleteConfirm}</h2>
                                    </a:outputPanel>
                                </div>
                                <a:outputPanel id="deleteHouseConfirm_form" role="form">
                                    <s:div styleClass="modal-body">


                                        <a:outputPanel id="deleteHouseConfirm_inputs">
                                            <s:div >
                                                <h:outputText value="#{buildGridMapHome.selectHouse.houseOrder}"
                                                              style="font-size: 1.2em; font-weight: bold;"/>
                                                <h:graphicImage rendered="#{not buildGridMapHome.houseCanEdit}"
                                                                value="/img/house/lock.png" title="#{messages.LockDecription}"/>
                                                <br/>
                                                <h:outputText value="#{messages.DeleteMapHouseInfo}" style="color: #e38d13"/>
                                                <br/>
                                                <h:outputText value="#{messages.IdleMapHouseInfo}" style="color: #b92c28"/>
                                            </s:div>

                                        </a:outputPanel>
                                    </s:div>
                                    <a:outputPanel layout="block" styleClass="modal-footer" id="deleteHouseConfirm_buttons">
                                        <a:commandButton action="#{buildGridMapHome.deleteBlockHouse}"
                                                         disabled="#{not buildGridMapHome.houseCanEdit}"
                                                         styleClass="btn btn-danger"
                                                         render="grid_map" status="processWaiting"
                                                         onclick="$('#deleteHouseConfirm').modal('hide');"
                                                         value="#{messages.BuildMapAction_delete}" execute="@this">
                                            <a:attachQueue requestDelay="0"/>
                                        </a:commandButton>


                                        <a:commandButton action="#{buildGridMapHome.idleBlockHouse}"
                                                         value="#{messages.BuildMapAction_idle}"
                                                         onclick="$('#deleteHouseConfirm').modal('hide');"
                                                         styleClass="btn btn-warning"
                                                         status="processWaiting"
                                                         execute="@this" render="grid_map,idle">
                                            <a:attachQueue requestDelay="0"/>
                                        </a:commandButton>

                                        <a:commandButton immediate="true"
                                                         styleClass="btn btn-default"
                                                         execute="@this" value="#{messages.cancel}"
                                                         onclick="$('#deleteHouseConfirm').modal('hide'); return false;">
                                        </a:commandButton>
                                    </a:outputPanel>
                                </a:outputPanel>
                            </div>
                        </div>
                    </div>


                    <r:popupPanel id="idleHousePopup" resizeable="true" minWidth="250" minHeight="264" width="250"
                                  height="300" styleClass="cc"
                                  autosized="false" modal="false">
                        <f:facet name="header">
                            <h4>
                            <h:outputText value="#{messages.IdleHouse}"/></h4>
                        </f:facet>
                        <f:facet name="controls">
                            <a:commandLink styleClass="table-action" status="processWaiting"
                                           title="#{messages.GridFillNew}"
                                           action="#{buildGridMapHome.generateHouse}"
                                           execute="@this"
                                           immediate="true" render="grid_map">
                                <span class="icon-plus"/>
                                #{messages.create}
                                <a:attachQueue requestDelay="0"/>
                            </a:commandLink>

                            <a:commandLink styleClass="table-action" action="#{buildGridMapHome.matchIdle}"
                                           status="processWaiting" title="#{messages.GridFillIdle}" execute="@this"
                                           immediate="true"
                                           render="grid_map,idle">
                                <span class="icon-magic"/>
                                #{messages.Fill}
                                <a:attachQueue requestDelay="0"/>
                            </a:commandLink>

                        </f:facet>
                        <a:outputPanel layout="block" style="width: 100%; height: 100%" id="idle">
                            <r:jQuery selector=".idle-house-con" event="mouseover"
                                      query="jQuery(this).find('.house-act').stop().fadeIn(10);"/>
                            <r:jQuery selector=".idle-house-con" event="mouseout"
                                      query="jQuery(this).find('.house-act').fadeOut(10);"/>

                            <r:panel
                                    style="color: #ddd; margin: 2px;float: left; width: 50px;height: 50px;background: url('#{facesContext.externalContext.requestContextPath}/img/house/createHouse.gif') center center no-repeat;">
                                <a:outputPanel layout="block" styleClass="rf-ind-drag">
                                    <r:dragSource type="newHouse" dragValue="newHouse" dragIndicator="indicator"/>
                                </a:outputPanel>
                            </r:panel>
                            <a:repeat value="#{idleHouses}" var="_idleHouse">
                                <r:panel styleClass="idle-house-con">
                                    <a:outputPanel layout="block" styleClass="rf-idle-drag">

                                        <r:dragSource id="idle_source" type="house" dragValue="#{_idleHouse}"
                                                      dragIndicator="indicator"/>

                                        <a:outputPanel>
                                            <h:outputText value="#{_idleHouse.houseOrder}"
                                                          style="font-size: 1em; font-weight: bold;#{_idleHouse.validator ? 'color: #000000;' : 'color: red;' }"/>
                                            <r:tooltip styleClass="tooltip-custom-body"
                                                       layout="block" mode="client"
                                                       rendered="#{(not _idleHouse.detailsValid) or (not _idleHouse.orderValid)}">
                                                <s:span rendered="#{not _idleHouse.detailsValid}"
                                                        style="white-space: normal">
                                                    <h:outputText styleClass="errors"
                                                                  value="#{messages.HouseDetailsError}"/>

                                                </s:span>
                                                <s:span rendered="#{not _idleHouse.orderValid}"
                                                        style="white-space: normal">
                                                    <h:outputText styleClass="errors"
                                                                  value="#{messages.HouseOrderConflict}"/>
                                                </s:span>
                                            </r:tooltip>

                                        </a:outputPanel>

                                        <br/>
                                        <h:outputText value="#{_idleHouse.houseArea}"
                                                      style="font-size: 0.9em;color: #797268;">
                                            <f:convertNumber pattern="#0.000"/>
                                        </h:outputText>
                                        <br/>
                                        <h:outputText value="#{_idleHouse.useArea}"
                                                      style="font-size: 0.9em;color: #797268;">
                                            <f:convertNumber pattern="#0.000"/>
                                        </h:outputText>
                                    </a:outputPanel>
                                    <h:graphicImage rendered="#{_idleHouse.lockStatus.lock}"
                                                    style="height: 16px;padding:0px;border: 0px;position:absolute; bottom:0;left:0"
                                                    value="/img/house/lock.png" title="#{messages.LockDecription}"/>
                                    <s:div styleClass="house-act">
                                        <a:commandButton rendered="#{not _idleHouse.lockStatus.lock}"
                                                         image="/img/icons/delete-red.png"
                                                         render="removeIdleHouseConfirm_form"
                                                         oncomplete="$('#removeIdleHouseConfirm').modal('show')"
                                                         action="#{buildGridMapHome.selectedIdleHouse}"
                                                         title="#{messages.BuildMapAction_delete}"
                                                         execute="@this" immediate="true">
                                            <a:attachQueue requestDelay="0"/>
                                        </a:commandButton>

                                        <a:commandButton style="padding-left: 1px; padding-right: 1px;"
                                                         image="/img/icons/info-blue.png"
                                                         action="#{buildGridMapHome.selectedIdleHouse}"
                                                         title="#{messages.BuildMapAction_edit}"
                                                         oncomplete="$('#editPanel').modal({show: true, backdrop: 'static'});"
                                                         immediate="true" execute="@this" render="editPanel_form">
                                            <a:attachQueue requestDelay="0"/>
                                        </a:commandButton>


                                    </s:div>
                                </r:panel>
                            </a:repeat>
                            <div style="clear: both;"/>
                        </a:outputPanel>
                    </r:popupPanel>

                </h:form>

                <ui:decorate template="/layout/delete_confirm_dialog.xhtml">
                    <ui:param name="panelId" value="removeIdleHouseConfirm"/>
                    <ui:param name="entityTitle" value="#{buildGridMapHome.selectHouse.houseOrder}"/>
                    <a:commandButton styleClass="btn btn-danger" action="#{buildGridMapHome.deleteIdleHouse}"
                                     status="processWaiting" style="width: 100%"
                                     value="#{messages.confirmDelete}" onclick="$('#removeIdleHouseConfirm').modal('hide')"
                                     render="idle" immediate="true" execute="@this">
                        <a:attachQueue requestDelay="0"/>
                    </a:commandButton>

                </ui:decorate>

                    <ui:decorate template="/layout/delete_confirm_dialog.xhtml">
                        <ui:param name="panelId" value="removeHouseConfig"/>
                        <ui:param name="entityTitle" value="#{buildGridMapHome.selectHouse.houseOrder}"/>
                        <a:commandButton styleClass="btn btn-danger" action="#{buildGridMapHome.deleteBlockHouse}"
                                         status="processWaiting" style="width: 100%"
                                         value="#{messages.confirmDelete}" onclick="$('#removeHouseConfig').modal('hide')"
                                         render="grid_map" immediate="true" execute="@this">
                            <a:attachQueue requestDelay="0"/>
                        </a:commandButton>
                    </ui:decorate>






                <r:popupPanel id="updateFilePopup" modal="true" onmaskclick="#{r:component('updateFilePopup')}.hide();"
                              autosized="true" resizeable="false" styleClass="context-modal-panel">


                    <h:form enctype="multipart/form-data">


                        <r:fileUpload maxFilesQuantity="5" title="#{messages.Upload_Build_XML}"
                                      serverErrorLabel="#{messages.fileUpload_serverErrorLabel}"
                                      deleteLabel="#{messages.fileUpload_deleteLabel}"
                                      doneLabel="#{messages.fileUpload_doneLabel}"
                                      cancelEntryControlLabel="#{messages.fileUpload_cancelEntryControlLabel}"
                                      addLabel="#{messages.fileUpload_addControlLabel}"
                                      progressLabel="#{messages.fileUpload_progressLabel}"
                                      sizeExceededLabel="#{messages.fileUpload_sizeErrorLabel}"
                                      uploadLabel="#{messages.fileUpload_uploadControlLabel}"
                                      transferErrorLabel="#{messages.fileUpload_transferErrorLabel}"
                                      clearAllLabel="#{messages.fileUpload_clearAllControlLabel}"
                                      clearLabel="#{messages.fileUpload_clearControlLabel}"
                                      stopControlLabel="#{messages.fileUpload_stopControlLabel}"
                                      fileUploadListener="#{buildGridMapHome.templeteFileUploadListener}"
                                      ontyperejected="alert('#{messages.unsupportedProcessDefFile}');"
                                      onuploadcomplete="#{r:component('updateFilePopup')}.hide();renderMap();"
                                      acceptedTypes="xml">

                        </r:fileUpload>



                    </h:form>
                </r:popupPanel>


                <ui:decorate template="/layout/edit-modalpanel.xhtml">
                    <ui:param name="panelId" value="editPanel"/>
                    <ui:param name="panelTitle" value="#{messages.House}#{messages.edit}"/>

                    <ui:define name="actionButtons">

                        <a:commandButton value="#{messages.ok}" execute="@form" styleClass="btn btn-primary"
                                         action="#{actionExecuteState.actionExecute}"
                                         data="#{actionExecuteState.lastState}"
                                         render="grid_map,idle"
                                         oncomplete="if (#{facesContext.maximumSeverity==null} || #{facesContext.maximumSeverity.ordinal lt 2}){$('#editPanel').modal('hide')}"/>

                    </ui:define>

                    <a:outputPanel layout="block" styleClass="form-group"
                                   rendered="#{not empty buildGridMapHome.selectHouse}">

                        <a:outputPanel rendered="#{buildGridMapHome.houseCanEdit}">


                            <div class="edit">

                                <ui:include src="/layout/house/HouseEdit.xhtml">
                                    <ui:param name="house" value="#{buildGridMapHome.selectHouse}"/>
                                </ui:include>

                            </div>


                        </a:outputPanel>


                        <s:div rendered="#{not buildGridMapHome.houseCanEdit}" style="width: 980px">
                            <table class="detailsTable">
                                <tr>
                                    <td class="detailsHead"></td>
                                </tr>
                            </table>
                            <ui:include src="/layout/house/HouseInfoView.xhtml">
                                <ui:param name="houseInfo" value="#{buildGridMapHome.selectHouse}"/>
                            </ui:include>
                        </s:div>
                    </a:outputPanel>


                </ui:decorate>

            </div>
        </s:div>


        <h:outputScript library="bootstrap" name="/js/bootstrap.min.js"/>
        <h:outputScript library="bootstrap-select" name="/js/bootstrap-select.min.js"/>
        <h:outputScript library="bootstrap-switch" name="/js/bootstrap-switch.js"/>
        <h:outputScript library="floatThead" name="jquery.floatThead.js"/>
        <h:outputScript library="bootstrap-datepicker" name="/js/bootstrap-datepicker.min.js"/>
        <h:outputScript library="bootstrap-datepicker" name="/locales/bootstrap-datepicker.zh-CN.min.js"/>
        <a:outputPanel ajaxRendered="true">
            <h:outputScript name="init.js"/>
        </a:outputPanel>
    </h:body>

</f:view>
</html>