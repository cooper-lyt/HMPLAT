<!DOCTYPE composition PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
        "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<ui:composition xmlns="http://www.w3.org/1999/xhtml"
                xmlns:s="http://jboss.org/schema/seam/taglib"
                xmlns:ui="http://java.sun.com/jsf/facelets"
                xmlns:f="http://java.sun.com/jsf/core"
                xmlns:h="http://java.sun.com/jsf/html"
                xmlns:a="http://richfaces.org/a4j"
                xmlns:r="http://richfaces.org/rich"
                xmlns:c="http://java.sun.com/jsp/jstl/core"
                xmlns:dh="http://www.dgsoft.com/jsf/html"
                xmlns:p="http://xmlns.jcp.org/jsf/passthrough"
                template="/layout/template.xhtml">

    <ui:insert name="ajax-param">

    </ui:insert>

    <ui:define name="ajax-param">
        <a:queue requestDelay="0"/>
    </ui:define>


    <ui:define name="func-body">

        <ui:define name="outcss">
            <h:outputStylesheet library="github" name="/css/github1.css"/>
            <h:outputStylesheet library="github" name="/css/github2.css"/>
        </ui:define>
        <a:outputPanel id="func-navigation" rendered="#{s:hasRole('system.runBusinessMgr')}" layout="block" styleClass="pagehead codesearch-head">
            <div class="container">
                <div style=" float: left; width: 250px; ">

                    <ui:include src="/layout/function-nav.xhtml">
                        <ui:param name="functions" value="#{authInfo.workFunctions}"/>
                    </ui:include>

                    <span class="funcTitle">#{messages.BusinessView}</span>


                </div>

                    <h:form styleClass="search_repos">
                        <div class="flex-table search-form-fluid">
                            <div class="flex-table-item flex-table-item-primary">
                                <div class="input-block">
                                    <h:inputText styleClass="form-control" value="#{ownerBusinessView.id}"
                                                 p:placeholder="#{messages.BUSINESS_CODE}"/>


                                    <!-- /btn-group -->
                                </div>
                                <!-- /input-group -->
                            </div>
                            <div class="flex-table-item">
                                <h:commandLink styleClass="button" action="#{ownerBusinessHome.refresh}">
                                    #{messages.Search}
                                </h:commandLink>
                            </div>
                        </div>
                    </h:form>

            </div>
        </a:outputPanel>
        <div class="container">
            <h:outputStylesheet name="biz.css"/>

            <a:outputPanel rendered="#{s:hasRole('system.runBusinessMgr')}">



                <ui:decorate template="/layout/edit-modalpanel.xhtml">
                    <ui:param name="panelId" value="stopConfirmPanel"/>
                    <ui:param name="panelTitle" value="#{messages.StopConfirmTitle}"/>
                    <ui:define name="panelBody">

                        <s:decorate styleClass="form-group" template="/layout/edit-big.xhtml" >
                            <ui:define name="label">
                                <p>#{messages.StopConfirm_confirm_description}</p>
                            </ui:define>
                            <ui:param name="for" value="stopCommentsInput"/>
                            <h:inputTextarea id="stopCommentsInput" styleClass="form-control" rows="4" value="#{ownerBusinessView.comments}"
                                             p:placeholder="#{messages.businessComments}">

                            </h:inputTextarea>

                        </s:decorate>
                    </ui:define>
                    <ui:define name="actionButtons">

                        <a:commandButton styleClass="button button-block danger" action="#{ownerBusinessView.terminationBiz}"
                                         value="#{messages.confirmStop}" render="context"
                                         oncomplete="$('#stopConfirmPanel').modal('hide')"
                                         execute="@form">
                            <a:attachQueue requestDelay="0"/>
                        </a:commandButton>


                    </ui:define>

                </ui:decorate>

                <ui:decorate template="/layout/edit-modalpanel.xhtml">
                    <ui:param name="panelId" value="suspendConfirmPanel"/>
                    <ui:param name="panelTitle" value="#{messages.SuspendConfirmTitle}"/>
                    <ui:define name="panelBody">

                        <s:decorate styleClass="form-group" template="/layout/edit-big.xhtml" >
                            <ui:define name="label">
                                <p>#{messages.suspend_confirm_description}</p>
                            </ui:define>
                            <ui:param name="for" value="suspendCommentsInput"/>
                            <h:inputTextarea id="suspendCommentsInput" styleClass="form-control" rows="4" value="#{ownerBusinessView.comments}"
                                             p:placeholder="#{messages.businessComments}">

                            </h:inputTextarea>

                        </s:decorate>
                    </ui:define>
                    <ui:define name="actionButtons">

                        <a:commandButton styleClass="button button-block danger" action="#{ownerBusinessView.suspendBiz}"
                                         value="#{messages.confirmSuspend}" render="context"
                                         oncomplete="$('#suspendConfirmPanel').modal('hide')"
                                         execute="@form">
                            <a:attachQueue requestDelay="0"/>
                        </a:commandButton>


                    </ui:define>

                </ui:decorate>

                <ui:decorate template="/layout/edit-modalpanel.xhtml">
                    <ui:param name="panelId" value="resumeConfirmPanel"/>
                    <ui:param name="panelTitle" value="#{messages.ResumeConfirmeTitle}"/>
                    <ui:define name="panelBody">


                        <s:decorate styleClass="form-group" template="/layout/edit-big.xhtml" >
                            <ui:define name="label">
                                <p>#{messages.resume_confirme_description}</p>
                            </ui:define>
                            <ui:param name="for" value="resumeCommentsInput"/>
                            <h:inputTextarea id="resumeCommentsInput" styleClass="form-control" rows="4"
                                             p:placeholder="#{messages.businessComments}" value="#{ownerBusinessView.comments}">

                            </h:inputTextarea>

                        </s:decorate>
                    </ui:define>
                    <ui:define name="actionButtons">

                        <a:commandButton styleClass="btn button-block btn-success btn-reversal" action="#{ownerBusinessView.resumeBiz}"
                                         value="#{messages.confirmResume}" render="context"
                                         oncomplete="$('#resumeConfirmPanel').modal('hide')"
                                         execute="@form">
                            <a:param value="#{ownerBusinessView.id}" assignTo="#{ownerBusinessView.id}"/>
                            <a:attachQueue requestDelay="0"/>
                        </a:commandButton>


                    </ui:define>

                </ui:decorate>


                <ui:decorate template="/layout/edit-modalpanel.xhtml">
                    <ui:param name="panelId" value="assignConfirmPanel"/>
                    <ui:param name="panelTitle" value="#{messages.AssignConfirmTitle}#{' '}#{actorName}"/>
                    <ui:define name="panelBody">


                        <s:decorate styleClass="form-group" template="/layout/edit-big.xhtml" >
                            <ui:define name="label">
                                <p>#{messages.assign_confirm_description}</p>
                            </ui:define>
                            <ui:param name="for" value="assignCommentsInput"/>
                            <h:inputTextarea id="assignCommentsInput" styleClass="form-control" rows="4"
                                             p:placeholder="#{messages.businessComments}" value="#{ownerBusinessView.comments}">

                            </h:inputTextarea>

                        </s:decorate>
                    </ui:define>
                    <ui:define name="actionButtons">

                        <a:commandButton styleClass="btn button-block btn-success btn-reversal" action="#{ownerBusinessView.assignTo}"
                                         value="#{messages.confirmAssign}#{' '}#{actorName}" render="context"
                                         oncomplete="$('#assignConfirmPanel').modal('hide')"
                                         execute="@form">

                            <a:attachQueue requestDelay="0"/>
                        </a:commandButton>


                    </ui:define>

                </ui:decorate>

            </a:outputPanel>


            <h:form >

                <a:outputPanel layout="block" id="context" styleClass="container">

                    <a:outputPanel layout="block" styleClass="blankslate" rendered="#{not ownerBusinessHome.idDefined}">

                        <span class="mega-octicon octicon-search"></span>

                        <h3>#{messages.EmptyResult}</h3>

                        <p>  #{messages.business_not_found_message}

                        </p>


                    </a:outputPanel>

                    <h:outputStylesheet>

                        .dashboard-notice.BIZ_CREATE .octicon-repo {
                            color: #4183c4;
                        }

                        .dashboard-notice.BIZ_AFTER_SAVE .octicon-repo {
                            color: #f0ad4e;
                        }

                        .dashboard-notice.BIZ_IMPORT .octicon-repo {
                            color: #d9534f;
                        }

                        .dashboard-notice.recorded h2 {
                            color: #4078c0;
                        }

                        .alert:not(:last-child){
                            margin-bottom: 5px;
                        }

                        .alert .octicon{
                            font-weight: bold;
                        }

                    </h:outputStylesheet>


                    <a:outputPanel rendered="#{ownerBusinessHome.idDefined}">

                        <div>

                            <ui:include src="BusinessMessageList.xhtml">
                                <ui:param name="processMessageList" value="#{ownerBusinessHome.instance.processMessageList}"/>
                            </ui:include>

                            <a:outputPanel layout="block" styleClass="rf-msgs-wrn"
                                           rendered="#{ownerBusinessHome.haveLaterUploadFile}">
                                <span class="octicon octicon-alert" style="font-weight: bold"/> #{messages.haveLaterUploadNeedFile}
                            </a:outputPanel>

                        </div>


                        <ui:decorate template="/layout/delete_confirm_dialog.xhtml">
                            <ui:param name="panelId" value="businessDeleteConfirmPanel"/>
                            <ui:param name="entityTitle" value="#{ownerBusinessHome.id}"/>
                            <ui:define name="panelBody">
                                <p>确认要撤回业务 <h:outputText value="中止后将无法还原" style="color: #900"/> </p>
                                <p>
                                    <h:outputText value="此业务为补录业务，将会直接被中止！" rendered="#{ownerBusinessHome.instance.source eq 'BIZ_AFTER_SAVE'}"/>
                                    <h:outputText value="将启动撤回业务流程！" rendered="#{not (ownerBusinessHome.instance.source eq 'BIZ_AFTER_SAVE')}"/>
                                </p>
                            </ui:define>

                            <s:button styleClass="button button-block danger" action="#{businessCancel.cancelBusiness}"
                                             value="#{(ownerBusinessHome.instance.source eq 'BIZ_AFTER_SAVE') ? '我确认要中止此业务' : '启动撤回业务流程'}"/>

                        </ui:decorate>


                        <div class="dashboard-notice #{ownerBusinessHome.instance.source} #{ownerBusinessHome.instance.recorded ? 'recorded' : ''}" style="margin-top: 5px">

                            <a:outputPanel layout="block" styleClass="right" rendered="#{not (ownerBusinessHome.instance.status eq 'ABORT')}">

                                <div class="btn-group" role="group" >

                                    <h:outputLink rendered="#{ ownerBusinessView.hasCreateRole or ((ownerBusinessHome.instance.source eq 'BIZ_AFTER_SAVE') and s:hasRole('recordRunManager') )}"
                                            p:aria-label="#{messages.cancelBusiness}" onclick="$('#businessDeleteConfirmPanel').modal('show');return false;"
                                            styleClass="btn btn-default #{ownerBusinessHome.canCancel ? '' : 'disabled'} tooltipped tooltipped-s"
                                            disabled="#{not ownerBusinessHome.canCancel}">
                                        <span class="btn-icon octicon octicon-x"></span>
                                    </h:outputLink>


                                    <s:link rendered="#{ownerBusinessView.hasCreateRole}" propagation="begin"
                                            p:aria-label="#{messages.modifyBusiness}"
                                            action="#{houseBusinessModifyStart.startModify}"
                                            styleClass="btn btn-default #{ownerBusinessHome.canModify ? '' : 'disabled'} tooltipped tooltipped-s"
                                            disabled="#{not ownerBusinessHome.canModify}">

                                        <span class="btn-icon octicon octicon-pencil"></span>
                                        <f:param name="normalBiz" value="false"/>
                                        <f:param name="selectBusinessId" value="#{ownerBusinessHome.instance.id}"/>
                                    </s:link>

                                    <a:outputPanel layout="block" styleClass="btn-group">


                                        <button type="button" disabled="#{businessDefineHome.haveReport ? '' : 'disabled'}"
                                                aria-label="#{messages.ASSIGN}" onclick="showEmpMenu()"
                                                class="btn btn-default select-menu-button dropdown-toggle #{businessDefineHome.haveReport ? '' : 'disabled'}" data-toggle="dropdown">

                                                <span class="btn-icon glyphicon glyphicon-print"></span>

                                        </button>


                                        <div class="dropdown-menu select-menu-modal-holder dropdown-menu-right">
                                        <div class="select-menu-modal">
                                            <div class="select-menu-header">
                                                <span class="select-menu-title">#{messages.print_title}</span>
                                                <span class="octicon octicon-x js-menu-close"
                                                      aria-label="#{messages.close}"></span>
                                            </div>
                                                <div>
                                            <div class="select-menu-list">
                                                <a:repeat value="#{businessDefineHome.reprotList}" var="_item">

                                                    <s:link styleClass="select-menu-item" view="#{_item.page}" target="_blank">

                                                        <span class="select-menu-item-icon octicon octicon-check"></span>
                                                        <span class="select-menu-item-text">#{_item.name}</span>

                                                        <f:param name="businessId" value="#{ownerBusinessHome.id}"/>
                                                        <f:param name="businessDefineId" value="#{businessDefineHome.id}"/>
                                                    </s:link>

                                                </a:repeat>
                                            </div>
                                                </div>
                                        </div>


                                        </div>

                                    </a:outputPanel>


                                    <a:commandLink type="button" class="btn btn-success btn-reversal #{ownerBusinessView.canResume ? '' : 'disabled'} tooltipped tooltipped-s"
                                                   disabled="#{not ownerBusinessView.canResume}"
                                                   rendered="#{(not empty processInstanceHome.instance) and s:hasRole('system.runBusinessMgr')}"
                                                   oncomplete="$('#resumeConfirmPanel').modal('show')"
                                                   p:aria-label="#{messages.CONTINUE}" immediate="true" execute="@this">
                                        <span class="btn-icon glyphicon glyphicon-play"></span>
                                        <a:attachQueue requestDelay="0"/>
                                        <a:param value="#{ownerBusinessView.id}" assignTo="#{ownerBusinessView.id}"/>
                                    </a:commandLink>
                                    <a:commandLink type="button" class="btn btn-warning btn-reversal #{ ownerBusinessView.canSuspend ? '' : 'disabled'} tooltipped tooltipped-s"
                                                   disabled="#{not ownerBusinessView.canSuspend}" oncomplete="$('#suspendConfirmPanel').modal('show')"
                                                   rendered="#{(not empty processInstanceHome.instance) and s:hasRole('system.runBusinessMgr')}"
                                                   p:aria-label="#{messages.SUSPEND}" immediate="true" execute="@this">
                                        <span class="btn-icon glyphicon glyphicon-pause"></span>
                                        <a:attachQueue requestDelay="0"/>
                                        <a:param value="#{ownerBusinessView.id}" assignTo="#{ownerBusinessView.id}"/>
                                    </a:commandLink>
                                    <a:commandLink type="button" class="btn btn-danger btn-reversal #{ownerBusinessView.canStop ? '' : 'disabled'} tooltipped tooltipped-s"
                                                   disabled="#{not ownerBusinessView.canStop}"
                                                   rendered="#{(not empty processInstanceHome.instance) and s:hasRole('system.runBusinessMgr')}"
                                                   oncomplete="$('#stopConfirmPanel').modal('show')" p:aria-label="#{messages.TERMINATION}"
                                                   immediate="true" execute="@this">
                                        <span class="btn-icon glyphicon glyphicon-stop"></span>
                                        <a:attachQueue requestDelay="0"/>
                                        <a:param value="#{ownerBusinessView.id}" assignTo="#{ownerBusinessView.id}"/>
                                    </a:commandLink>

                                    <a:jsFunction name="showEmpMenu" action="#{employeeList.resetResultCount}"
                                                  render="sectionSelectPanel" execute="@this" immediate="true"/>

                                    <a:outputPanel layout="block" styleClass="btn-group" rendered="#{(not empty processInstanceHome.instance) and s:hasRole('system.runBusinessMgr')}">


                                        <button type="button"
                                                aria-label="#{messages.ASSIGN}" onclick="showEmpMenu()"
                                                class="btn btn-default select-menu-button dropdown-toggle #{ (ownerBusinessHome.instance.status eq 'RUNNING')? '' : 'disabled'}" data-toggle="dropdown">

                                                <span class="btn-icon octicon octicon-person"></span>


                                        </button>

                                        <div class="dropdown-menu select-menu-modal-holder dropdown-menu-right">
                                            <div class="select-menu-modal">
                                                <div class="select-menu-header">
                                                    <span class="select-menu-title">#{messages.assign_title}</span>
                                            <span class="octicon octicon-x js-menu-close"
                                                  aria-label="#{messages.close}"></span>
                                                </div>

                                                <a:outputPanel layout="block" id="sectionSelectPanel">
                                                    <div class="select-menu-filters">
                                                        <div class="select-menu-text-filter">
                                                            <h:inputText id="sectionSearchName" autocomplete="off" value="#{employeeList.searchKey}">
                                                                <a:ajax event="keyup" immediate="true" execute="@this"
                                                                        render="SectionSelectItemList">
                                                                    <a:attachQueue requestDelay="500"/>
                                                                </a:ajax>

                                                            </h:inputText>
                                                        </div>
                                                    </div>
                                                    <a:outputPanel layout="block" styleClass="select-menu-list" id="SectionSelectItemList">


                                                        <a:repeat value="#{employeeList.resultList}" var="_item">

                                                            <a:commandLink execute="@this" immediate="true"
                                                                           render="assignConfirmPanel_form,assignConfirmPanel_title"
                                                                           oncomplete="$('#assignConfirmPanel').modal('show')"
                                                                           styleClass="select-menu-item">
                                                                <a:attachQueue requestDelay="0"/>
                                                                <f:param name="actorId" value="#{_item.id}"/>
                                                                <f:param name="taskId" value="#{null}"/>
                                                                <f:param name="actorName" value="#{_item.personName}"/>
                                                                <span class="select-menu-item-icon octicon octicon-check"></span>
                                                                <span class="select-menu-item-text">#{_item.personName}</span>
                                                            </a:commandLink>
                                                        </a:repeat>





                                                        <a:commandLink onclick="moreBefor();moreResult(); event.stopPropagation(); return false;"
                                                                       styleClass="select-menu-item last-visible"
                                                                       rendered="#{employeeList.nextExists}">


                                                            <span class="select-menu-item-icon octicon octicon-check"></span>
                                                            <span class="select-menu-item-text">#{messages.More}</span>
                                                            <a:attachQueue requestDelay="0"/>
                                                        </a:commandLink>
                                                    </a:outputPanel>

                                                </a:outputPanel>

                                            </div>
                                        </div>
                                    </a:outputPanel>




                                </div>

                            </a:outputPanel>

                            <h:outputScript>
                                var scrollTopValue1 = 0;

                                function moreBefor(){
                                var div = #{r:element('SectionSelectItemList')};
                                scrollTopValue1 = div.scrollTop;

                                }

                                function scrollToBefor(){
                                var div = #{r:element('SectionSelectItemList')};

                                div.scrollTop = scrollTopValue1;
                                }

                            </h:outputScript>

                            <a:jsFunction name="moreResult" execute="@this" immediate="true" action="#{employeeList.moreResult}"
                                          oncomplete="scrollToBefor() "
                                          render="SectionSelectItemList">
                                <a:attachQueue requestDelay="0"/>
                            </a:jsFunction>

                            <span class="mega-octicon octicon-repo"></span>

                            <h2><strong>#{ownerBusinessHome.instance.defineName}</strong>
                                <h:outputText value="#{messages[ownerBusinessHome.instance.type]}"
                                              rendered="#{not (ownerBusinessHome.instance.type eq 'NORMAL_BIZ')}"/>
                                #{ownerBusinessHome.instance.id}
                                <span class="label label-biz-status #{ownerBusinessHome.instance.status} tooltipped tooltipped-s" aria-label="#{messages[ownerBusinessHome.instance.source]} #{ownerBusinessHome.instance.recorded ? messages.OwnerBusinessRecord : messages.OwnerBusinessNoRecord} #{messages[ownerBusinessHome.instance.status.name()]}"> #{messages[ownerBusinessHome.instance.status.name()]}</span>
                            </h2>

                            <p class="repo-list-description">
                                #{ownerBusinessHome.instance.memo}
                            </p>


                            <p class="repo-list-meta">


                                <h:outputText value="#{messages['ownerBusiness.applyTime']}"
                                              rendered="#{not empty ownerBusinessHome.instance.applyTime}"/>
                                <h:outputText value="#{ownerBusinessHome.instance.applyTime}"
                                              rendered="#{not empty ownerBusinessHome.instance.applyTime}">
                                    <s:convertDateTime pattern="#{messages.displayDateTimePattern}"/>
                                </h:outputText>

                                <h:outputText value="#{messages['ownerBusiness.checkTime']}"
                                              rendered="#{not empty ownerBusinessHome.instance.checkTime}"/>
                                <h:outputText value=" #{ownerBusinessHome.instance.checkTime}"
                                              rendered="#{not empty ownerBusinessHome.instance.checkTime}">
                                    <s:convertDateTime pattern="#{messages.displayDateTimePattern}"/>
                                </h:outputText>

                                <h:outputText value="#{messages['ownerBusiness.regTime']}"
                                              rendered="#{ownerBusinessHome.instance.recorded}"/>
                                <h:outputText value="#{ownerBusinessHome.instance.regTime}"
                                              rendered="#{ownerBusinessHome.instance.recorded}">
                                    <s:convertDateTime pattern="#{messages.displayDateTimePattern}"/>
                                </h:outputText>

                                <h:outputText value="#{messages['ownerBusiness.recordTime']}"
                                              rendered="#{not empty ownerBusinessHome.instance.recordTime}"/>
                                <h:outputText value="#{ownerBusinessHome.instance.recordTime}"
                                              rendered="#{not empty ownerBusinessHome.instance.recordTime}">
                                    <s:convertDateTime pattern="#{messages.displayDateTimePattern}"/>
                                </h:outputText>


                            </p>


                        </div>

                        <h:inputHidden value="#{ownerBusinessView.id}"/>
                        <r:tabPanel switchType="client">
                            <r:tab>
                                <f:facet name="header">
                                    <span class="octicon octicon-file-submodule"/>
                                    #{messages.businessFile}
                                </f:facet>

                                <ui:include src="BusinessFileView.xhtml" >
                                    <ui:param name="fileListBean" value="#{businessFileView}"/>
                                </ui:include>


                            </r:tab>

                            <c:forEach   items="#{ownerBusinessView.viewSubscribeDefineGroups}"

                                        var="_group">

                                <r:tab>

                                    <f:facet name="header">
                                        <span class="#{_group.group.iconCss}"/>
                                        #{_group.group.name}

                                    </f:facet>

                                    <dh:entryGrid styleClass="detailsTable table table-bordered "
                                                  groupWidth="#{_group.group.groupWidth}" keyWidth="#{_group.group.keyWidth}"
                                                  valueWidth="#{_group.group.valueWidth}">
                                        <c:forEach items="#{_group.defineList}" var="_item">

                                            <f:subview>
                                                <ui:include src="#{_item.page}"/>
                                            </f:subview>
                                        </c:forEach>
                                    </dh:entryGrid>
                                </r:tab>
                            </c:forEach>


                            <r:tab>
                                <f:facet name="header">
                                    <span class="octicon octicon-milestone"/>
                                    #{messages.bussinessFlowRecord}
                                </f:facet>



                                <ui:include src="TaskOperListGroup.xhtml">
                                    <ui:param name="taskOperList" value="#{ownerBusinessHome.taskOperList}"/>
                                </ui:include>


                            </r:tab>




                            <r:tab rendered="#{not empty processInstanceHome.instance}">
                                <f:facet name="header">
                                    <span class="octicon octicon-clock"/>
                                    #{messages.processTaskLog}
                                </f:facet>


                                <ul class="boxed-group-inner list-group notifications status-list-group">
                                    <a:repeat value="#{processInstanceHome.taskInstanceList}" var="_task">
                                        <li class="list-group-item issue-notification #{(_task.open and _task.signalling) ? 'list-group-item-info' : ''}">
                                <span class="list-group-item-name css-truncate"  style="max-width: 700px">
                                    <span class="type-icon octicon octicon-git-commit">

                                    </span>

                                     <h:outputText value="#{_task.name}" styleClass="css-truncate-target list-item-title"/>


                                    <div class="task-status-group">

                                        <a:outputPanel styleClass="tooltipped tooltipped-w task-status" p:aria-label="#{messages.jbpm_task_open}"  rendered="#{_task.open}" >
                                            <a:outputPanel styleClass="octicon octicon-alignment-align status-icon"/>
                                        </a:outputPanel>



                                        <a:outputPanel styleClass="tooltipped tooltipped-w task-status" rendered="#{_task.signalling}" p:aria-label="#{messages.jbpm_task_signalling}">
                                            <a:outputPanel styleClass="octicon octicon-git-pull-request status-icon"/>
                                        </a:outputPanel>


                                        <a:outputPanel styleClass="tooltipped tooltipped-w task-status" rendered="#{_task.last}" p:aria-label="#{messages.jbpm_task_last}">
                                            <span class="octicon octicon-alignment-aligned-to status-icon"/>

                                        </a:outputPanel>


                                        <a:outputPanel styleClass="tooltipped tooltipped-w task-status" rendered="#{_task.suspended}" p:aria-label="#{messages.jbpm_task_suspended}">
                                            <span class="octicon octicon-playback-pause status-icon">

                                            </span>
                                        </a:outputPanel>



                                        <a:outputPanel styleClass="tooltipped tooltipped-w task-status " rendered="#{_task.blocking}" p:aria-label="#{messages.jbpm_task_blocking}">
                                            <span class="octicon octicon-alignment-unalign status-icon"/>
                                        </a:outputPanel>




                                        <a:outputPanel styleClass="tooltipped tooltipped-w task-status" rendered="#{_task.cancelled}" p:aria-label="#{messages.jbpm_task_cancelled}">
                                            <span class="octicon octicon-x status-icon"/>
                                        </a:outputPanel>

                                    </div>

                             <h:outputText value="#{_task.create}" styleClass="css-truncate-target list-item-description" style="max-width: 200px">
                                 <s:convertDateTime pattern="#{messages.displayDateTimePattern}"/>
                             </h:outputText>

        <h:outputText value="#{_task.end}" styleClass="css-truncate-target list-item-description" style="max-width: 200px">
            <s:convertDateTime pattern="#{messages.displayDateTimePattern}"/>
        </h:outputText>

                                </span>

                                            <ul class="notification-actions">

                                                <li>

                                                    <a:outputPanel rendered="#{(not empty processInstanceHome.instance) and s:hasRole('system.runBusinessMgr') and (_task.open) and _task.signalling}">
                                                        <f:subview>

                                                            <h:outputScript>
                                                                var scrollTopValue2 = 0;

                                                                function moreBefor(){
                                                                var div = #{r:element('SectionSelectItemList')};
                                                                scrollTopValue2 = div.scrollTop;

                                                                }

                                                                function scrollToBefor(){
                                                                var div = #{r:element('SectionSelectItemList')};

                                                                div.scrollTop = scrollTopValue2;
                                                                }

                                                            </h:outputScript>

                                                            <a:jsFunction name="showSubEmpMenu" action="#{employeeList.resetResultCount}"
                                                                          render="sectionSelectPanel" execute="@this" immediate="true"/>

                                                            <a:jsFunction name="moreSubResult" execute="@this" immediate="true" action="#{employeeList.moreResult}"
                                                                          oncomplete="scrollToBefor() "
                                                                          render="SectionSelectItemList">
                                                                <a:attachQueue requestDelay="0"/>
                                                            </a:jsFunction>


                                                            <a aria-label="#{messages.ASSIGN}" onclick="showSubEmpMenu()" style="cursor: pointer"
                                                               class=" #{ (ownerBusinessHome.instance.status eq 'RUNNING')? '' : 'disabled'}" data-toggle="dropdown">
                                                                <span class="octicon octicon-person"></span>
                                                                <span class="dropdown-caret" style="vertical-align: -2px"/>
                                                                <a:attachQueue requestDelay="0"/>
                                                            </a>

                                                            <div class="dropdown-menu select-menu-modal-holder dropdown-menu-right">
                                                                <div class="select-menu-modal">
                                                                    <div class="select-menu-header">
                                                                        <span class="select-menu-title">#{messages.assign_title}</span>
                                            <span class="octicon octicon-x js-menu-close"
                                                  aria-label="#{messages.close}"></span>
                                                                    </div>

                                                                    <a:outputPanel layout="block" id="sectionSelectPanel">
                                                                        <div class="select-menu-filters">
                                                                            <div class="select-menu-text-filter">
                                                                                <h:inputText id="sectionSearchName" autocomplete="off" value="#{employeeList.searchKey}">
                                                                                    <a:ajax event="keyup" immediate="true" execute="@this"
                                                                                            render="SectionSelectItemList">
                                                                                        <a:attachQueue requestDelay="500"/>
                                                                                    </a:ajax>

                                                                                </h:inputText>
                                                                            </div>
                                                                        </div>
                                                                        <a:outputPanel layout="block" styleClass="select-menu-list" id="SectionSelectItemList">


                                                                            <a:repeat value="#{employeeList.resultList}" var="_item">

                                                                                <a:commandLink execute="@this" immediate="true"
                                                                                               render="assignConfirmPanel_form,assignConfirmPanel_title"
                                                                                               oncomplete="$('#assignConfirmPanel').modal('show')"
                                                                                               disabled="#{(_task.actorId eq _item.id)}"
                                                                                               styleClass="select-menu-item #{(_task.actorId eq _item.id) ? 'selected disabled': ''}">
                                                                                    <a:attachQueue requestDelay="0"/>
                                                                                    <f:param name="actorId" value="#{_item.id}"/>
                                                                                    <f:param name="taskId" value="#{_task.id}"/>
                                                                                    <f:param name="actorName" value="#{_item.personName}"/>
                                                                                    <span class="select-menu-item-icon octicon octicon-check"></span>
                                                                                    <span class="select-menu-item-text">#{_item.personName}</span>
                                                                                </a:commandLink>
                                                                            </a:repeat>





                                                                            <a:commandLink onclick="moreBefor();moreSubResult(); event.stopPropagation(); return false;"
                                                                                           styleClass="select-menu-item last-visible"
                                                                                           rendered="#{employeeList.nextExists}">


                                                                                <span class="select-menu-item-icon octicon octicon-check"></span>
                                                                                <span class="select-menu-item-text">#{messages.More}</span>
                                                                                <a:attachQueue requestDelay="0"/>
                                                                            </a:commandLink>
                                                                        </a:outputPanel>

                                                                    </a:outputPanel>

                                                                </div>
                                                            </div>



                                                        </f:subview>
                                                    </a:outputPanel>


                                                </li>
                                                <ui:remove>
                                                    <li>
                                                        <a:commandLink render="#{_task.suspended and _task.open and not _task.cancelled}">
                                                            <span class="octicon octicon-playback-play" style="color: #5cb85c"/>
                                                        </a:commandLink>

                                                        <a:commandLink render="#{not _task.suspended and _task.open and not _task.cancelled}">
                                                            <span class="octicon octicon-playback-pause" style="color: #f0ad4e"/>
                                                        </a:commandLink>
                                                    </li>
                                                </ui:remove>
                                                <li>
                                                    <h:outputText value="#{dictionary.getEmpNameById(_task.actorId)}"
                                                                  styleClass="tooltipped tooltipped-w"
                                                                  p:aria-label="#{_task.actorId}"
                                                                  rendered="#{not empty _task.actorId}"/>
                                                </li>

                                            </ul>
                                        </li>
                                    </a:repeat>

                                </ul>
                            </r:tab>


                        </r:tabPanel>

                    </a:outputPanel>

                </a:outputPanel>
            </h:form>
        </div>


    </ui:define>






</ui:composition>