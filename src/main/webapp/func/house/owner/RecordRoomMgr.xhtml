<!DOCTYPE composition PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
        "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<ui:composition xmlns="http://www.w3.org/1999/xhtml"
                xmlns:s="http://jboss.org/schema/seam/taglib"
                xmlns:ui="http://java.sun.com/jsf/facelets"
                xmlns:f="http://java.sun.com/jsf/core"
                xmlns:h="http://java.sun.com/jsf/html"
                xmlns:a="http://richfaces.org/a4j"
                xmlns:r="http://richfaces.org/rich"
                xmlns:dh="http://www.dgsoft.com/jsf/html"
                xmlns:p="http://xmlns.jcp.org/jsf/passthrough"
                template="/layout/template-data.xhtml">

    <ui:define name="outcss">
        <h:outputStylesheet library="github" name="/css/github1.css"/>
        <h:outputStylesheet library="github" name="/css/github2.css"/>
    </ui:define>



    <ui:param name="funcName" value="数字档案室"/>

    <ui:define name="head-right">
        <h:form styleClass="search_repos #{recordRoomMgr.searchType}">
            <div class="flex-table search-form-fluid">
                <div class="flex-table-item flex-table-item-primary">

                    <div class="input-group input-block">
                        <div class="input-group-btn">


                            <h:selectOneMenu
                                    styleClass="selectpicker select-menu-btn input-group-first sm-radius js-search-type-select"
                                    value="#{recordRoomMgr.searchType}" onchange="searchTypeChange()">
                                <s:selectItems value="#{recordRoomMgr.allSearchTypes}" var="_item"
                                               itemValue="#{_item}" label="#{_item.label}"/>
                                <s:convertEnum/>
                            </h:selectOneMenu>


                        </div>

                        <h:inputText styleClass="form-control search_record_input "/>

                        <span class="input-group-addon search_location_input">架</span>
                        <h:inputText styleClass="form-control search_location_input"
                                     value="#{recordRoomMgr.frame}"></h:inputText>
                        <span class="input-group-addon search_location_input">柜</span>
                        <h:inputText styleClass="form-control search_location_input"
                                     value="#{recordRoomMgr.cabinet}"></h:inputText>
                        <span class="input-group-addon search_location_input">盒</span>
                        <h:inputText styleClass="form-control search_location_input"
                                     value="#{recordRoomMgr.box}"></h:inputText>

                        <!-- /btn-group -->
                    </div>


                    <!-- /input-group -->
                </div>
                <div class="flex-table-item">

                    <a:commandLink execute="@form" render="resultBox" styleClass="btn btn-default"
                                   action="#{recordRoomMgr.search}"
                                   value="#{messages.Search}">
                        <a:attachQueue requestDelay="0"/>
                    </a:commandLink>

                </div>
            </div>
        </h:form>
    </ui:define>

    <ui:define name="func-container">

        <h:outputStylesheet library="bootstrap-treeview" name="bootstrap-treeview.min.css"/>

        <h:outputStylesheet library="jquery-ad-gallery" name="/css/jquery.ad-gallery.css"/>

        <h:outputStylesheet library="jquery-fancybox" name="jquery.fancybox.css"/>

        <h:outputStylesheet>

            .search_repos .search_record_input {
                display: table-cell;
                border-bottom-right-radius: 3px !important;
                border-top-right-radius: 3px !important;
            }

            .search_repos.RECORD_LOCATION .search_record_input {
                display: none;
            }

            .search_repos .search_location_input {
                display: none;
            }

            .search_repos.RECORD_LOCATION .search_location_input {
                display: table-cell;
            }

        </h:outputStylesheet>

        <h:outputStylesheet>

            .ad-gallery {
                width: 98%;
                margin-top: 10px;
            }

            .ad-gallery .ad-image-wrapper {

            }

            .gh-header-show.edit-title {
                display: none;
            }

            .ad-controls .custome-controls {
                float: right;
            }

            .ad-controls .custome-controls a {
                margin: 0 5px;
            }

            .ad-image {
                cursor: pointer;
            }
        </h:outputStylesheet>

        <h:outputScript>
            function searchTypeChange() {

            $('.search_repos').removeAttr('class').attr('class', 'search_repos');
            $('.search_repos').addClass($('.js-search-type-select').val())
            }
        </h:outputScript>

        <div class="container-fluid">

            <a:outputPanel id="resultBox">
                <a:outputPanel rendered="#{not empty recordRoomMgr.resultBox}">

                    <a:outputPanel rendered="#{not recordRoomMgr.resultBox.emptyBox}">

                        <div class="file-group">

                            <div class="row">


                                <div class="col-md-5">
                                    <div id="tree" class="file-group-tree"></div>
                                </div>


                                <div class="col-md-7 ">

                                    <a class="btn btn-default js-print-btn"> <span class="glyphicon glyphicon-print"/> </a>
                                    <hr/>
                                    <div class="file-group-empty blankslate spacious large-format">
                                        <span class="octicon octicon-bell blankslate-icon" height="40"/>
                                        <h3>没有电子文件</h3>
                                        <p>没有电子文件,你可以 <h:outputLink>补扫文件</h:outputLink></p>
                                    </div>

                                    <div class="file-group-gallery">
                                        <div class="ad-gallery">
                                            <div class="ad-image-wrapper">
                                            </div>
                                            <div class="ad-controls">
                                                <div class="custome-controls"><a class="img-delete">删除</a><a class="img-print-view" target="_blank">打印</a>
                                                    <a class="img-orig-view" target="_blank">原图</a></div>
                                            </div>
                                            <div class="ad-nav">
                                                <div class="ad-thumbs">
                                                    <ul class="ad-thumb-list">

                                                    </ul>
                                                </div>
                                            </div>

                                        </div>
                                    </div>
                                </div>
                            </div>

                        </div>

                        <h:outputScript>
                            $(document).ready(
                            function () {


                            $('.file-group').fileShowGroup({data: '#{recordRoomMgr.resultBox.treeData}',
                            imageServer: '#{runParam.getStringParamValue('IMG_SERVER_ADDRESS')}',
                            loader_image:'#{facesContext.externalContext.requestContextPath}/img/adGallery/loader.gif',
                            slideshow: {
                            enable: false
                            },
                            onFileNodeSelected: function(event, data) {
                                alert()
                                if (data.nodeType == 'volume'){
                                        $('js-print-btn').show();
                                    $('js-print-btn').attr('href','#{facesContext.externalContext.requestContextPath}/report/PicturePrint.seam?fileId=' + $('div.ad-image img').data('file-id'));
                                }else if (data.nodeType == 'box'){
                                    $('js-print-btn').show();
                                    $('js-print-btn').attr('href','#{facesContext.externalContext.requestContextPath}/report/PicturePrint.seam?fileId=' + $('div.ad-image img').data('file-id'));

                                }else{
                                    $('js-print-btn').hide();

                                }

                            },

                            callbacks: {
                            afterImageVisible: function() {

                            $('.img-orig-view').attr('href','#{runParam.getStringParamValue('IMG_SERVER_ADDRESS')}img/orig/' + $('div.ad-image img').data('file-id'));
                            $('.img-print-view').attr('href','#{facesContext.externalContext.requestContextPath}/report/PicturePrint.seam?fileId=' + $('div.ad-image img').data('file-id'));


                            }}

                            });

                            });

                        </h:outputScript>




                    </a:outputPanel>

                    <a:outputPanel layout="block" rendered="#{recordRoomMgr.resultBox.emptyBox}"
                                   styleClass="blankslate spacious large-format">
                        <span class="mega-octicon octicon-milestone"></span>

                        <h3>#{recordRoomMgr.frame} 架 #{recordRoomMgr.cabinet} 柜 #{recordRoomMgr.box} 盒</h3>

                        <p> 此盒中没有文件 </p>
                    </a:outputPanel>


                </a:outputPanel>

            </a:outputPanel>


        </div>
        <h:outputScript library="jquery-mousewheel" name="jquery.mousewheel-3.0.6.pack.js"/>
        <h:outputScript library="bootstrap-treeview" name="bootstrap-treeview.min.js"/>
        <h:outputScript library="jquery-ad-gallery" name="/js/jquery.ad-gallery.js"/>
        <h:outputScript library="jquery-fancybox" name="jquery.fancybox.pack.js"/>

        <h:outputScript library="file-show-group" name="file-show-group.js"/>
    </ui:define>



</ui:composition>